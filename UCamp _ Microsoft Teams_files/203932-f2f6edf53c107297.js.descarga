"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[203932],{116003:(e,t,a)=>{var n;a.d(t,{m:()=>n}),function(e){e.Chat="Chat",e.Meeting="Meeting",e.Channel="Channel",e.ChannelMeeting="ChannelMeeting",e.PrivateMeetingSchedulingForm="PrivateMeetingSchedulingForm",e.ChannelMeetingSchedulingForm="ChannelMeetingSchedulingForm",e.SingleTeamGridView="SingleTeamGridView",e.MeetingChat="MeetingChat",e.SelectAppEntity="SelectAppEntity"}(n||(n={}))},759704:(e,t,a)=>{var n,r;a.d(t,{u:()=>n,p:()=>r}),function(e){e.config="config",e.create="create",e.tenantLogin="tenantLogin",e.tenantRedemption="tenantRedemption",e.default="default",e.delete="delete",e.error="error",e.health="health",e.info="info",e.infoDetails="infoDetails",e.join="join",e.list="list",e.signin="signin",e.update="update",e.view="view",e.manage="manage",e.mutate="mutate",e.share="share",e.leave="leave",e.confirm="confirm",e.empty="empty"}(n||(n={})),function(e){e.acceptsharedchannelinvitationdialog="acceptsharedchannelinvitationdialog",e.accessibilitypanel="accessibilitypanel",e.accounts="accounts",e.activity="activity",e.addchannel="addchannel",e.addmember="addmember",e.addmembernewteam="addmembernewteam",e.addmembertoprivatechanneldialog="addmembertoprivatechanneldialog",e.addmembertoteamdialog="addmembertoteamdialog",e.agendapage="agendapage",e.alttext="alttext",e.activecalldialog="activecalldialog",e.archiveteam="archiveteam",e.attendancereport="attendancereport",e.annotation="annotation",e.appdetails="appdetails",e.attendeeview="attendeeview",e.autobrbconfirmationdialog="autobrbconfirmationdialog",e.autoinstallnotification="autoinstallnotification",e.bannerNotification="bannerNotification",e.blank="blank",e.blockChat="blockChat",e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.breakoutroomsassignment="breakoutroomsassignment",e.breakoutroomsassignmenttype="breakoutroomsassignmenttype",e.breakoutroomscreaterooms="breakoutroomscreaterooms",e.breakoutroomsdeleteroom="breakoutroomsdeleteroom",e.breakoutroomsdeleterooms="breakoutroomsdeleterooms",e.breakoutroomseditroom="breakoutroomseditroom",e.breakoutroomssettings="breakoutroomssettings",e.breakoutroomspanel="breakoutroomspanel",e.broadcastfeedback="broadcastfeedback",e.broadcastliveevent="broadcastliveevent",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calendar="calendar",e.callablechannels="callablechannels",e.callingconfirmdialog="callingconfirmdialog",e.callingalertdialog="callingalertdialog",e.callingbannernotification="callingbannernotification",e.callingdeeplink="callingdeeplink",e.callingdeeplinkDialog="callingdeeplinkDialog",e.callingprotocoldeeplinkdialog="callingprotocoldeeplinkdialog",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.callskeypad="callskeypad",e.callsmain="callsmain",e.callsmonitor="callsmonitor",e.callstransfer="callstransfer",e.cameraeffects="cameraeffects",e.cast="cast",e.channelcalendar="channelcalendar",e.channelconnectors="channelconnectors",e.channeldeeplink="channeldeeplink",e.channeldelete="channeldelete",e.channeledit="channeledit",e.channelemail="channelemail",e.channelemailerror="channelemailerror",e.channelemailv2="channelemailv2",e.channelinvitations="channelinvitations",e.channelanalytics="channelanalytics",e.channelmanage="channelmanage",e.channelmembers="channelmembers",e.channelmoderators="channelmoderators",e.channelsettings="channelsettings",e.channeltags="channeltags",e.channelnotificationsettings="channelnotificationsettings",e.channelroster="channelroster",e.channels="channels",e.channelsPinnedPost="channelsPinnedPost",e.channelsSystemMessage="channelsSystemMessage",e.channelcontextualsearch="channelcontextualsearch",e.chats="chats",e.chatschannelconv="chatschannelconv",e.chatContextualSearch="chatContextualSearch",e.chatHighlightsDetails="chatHighlightsDetails",e.chatInviteConfirmation="chatInviteConfirmation",e.chatManageApps="chatManageApps",e.chatsInfo="chatsInfo",e.chatsInfoView="chatsInfoView",e.closedcaptionssettings="closedcaptionssettings",e.classesintegrationcontent="classesintegrationcontent",e.coachreport="coachreport",e.connectedcalendardialog="connectedcalendardialog",e.codesnippet="codesnippet",e.communities="communities",e.communitiesaddmember="communitiesaddmember",e.communitiesevents="communitiesevents",e.communitiescreatechannel="communitiescreatechannel",e.communitiescreateevent="communitiescreateevent",e.communitiesguidelinesdialog="communitiesguidelinesdialog",e.communitiesjoinrequest="communitiesjoinrequest",e.communitiesmembers="communitiesmembers",e.communitiesgetappdialog="communitiesgetappdialog",e.communitiescreatedialog="communitiescreatedialog",e.communitieseditdialog="communitieseditdialog",e.communitiesonboarding="communitiesonboarding",e.communitiesjoininviteview="communitiesjoininviteview",e.communitiessendpostasemaildialog="communitiessendpostasemaildialog",e.contactssync="contactssync",e.contentcamerasetup="contentcamerasetup",e.coursecalendar="coursecalendar",e.courseteams="courseteams",e.createchanneldialog="createchanneldialog",e.crosspostchannelselectiondialog="crosspostchannelselectiondialog",e.crosspostchannelselectiondialogV2="crosspostchannelselectiondialogV2",e.crosspostdeletedialog="crosspostdeletedialog",e.crossteamanalytics="crossteamanalytics",e.customapp="customapp",e.customizereactions="customizereactions",e.default="default",e.defaultchannelnavdialog="defaultchannelnavdialog",e.deletechannelreactdialog="deletechannelreactdialog",e.deletechat="deletechat",e.deleteteam="deleteteam",e.deleteActivityFeedItem="deleteActivityFeedItem",e.devicesettings="devicesettings",e.discoversurface="discoversurface",e.dlp="dlp",e.discoverappsnotifications="discoverappsnotifications",e.eduteamcreate="eduteamcreate",e.email="email",e.esp="esp",e.error="error",e.events="events",e.eventsbroadcastqna="eventsbroadcastqna",e.example="example",e.extensions="extensions",e.externalnavigation="externalnavigation",e.faceenrollment="faceenrollment",e.file="file",e.filepicker="filepicker",e.fileopensettings="fileopensettings",e.filesoneupviewer="filesoneupviewer",e.floatingmonitor="floatingmonitor",e.floodgate="floodgate",e.fluid="fluid",e.flyout="flyout",e.framework="framework",e.freemiumupgrade="freemiumupgrade",e.gallery="gallery",e.galleryImages="galleryImages",e.getlinktoteamorchanneldialog="getlinktoteamorchanneldialog",e.giphyconsent="giphyconsent",e.givefeedbackchoices="givefeedbackchoices",e.guardians="guardians",e.help="help",e.homepage="homepage",e.hostedincontextstore="hostedincontextstore",e.hybridplaceholder="hybridplaceholder",e.hyperlink="hyperlink",e.identity="identity",e.identitydialog="identitydialog",e.inAppToast="inAppToast",e.incontextstore="incontextstore",e.invisionwhiteboard="invisionwhiteboard",e.invitecoworkers="invitecoworkers",e.joinlinkdialog="joinlinkdialog",e.leavechanneldialog="leavechanneldialog",e.leavechannellastownerdialog="leavechannellastownerdialog",e.leavechat="leavechat",e.leavecommunity="leavecommunity",e.leaveteam="leaveteam",e.leaveGroupAndBlockUser="leaveGroupAndBlockUser",e.licenses="licenses",e.linkedin="linkedin",e.livepersonacard="livepersonacard",e.livepersonaeditor="livepersonaeditor",e.lobnotifications="lobnotifications",e.locationapi="locationapi",e.locationnotification="locationnotification",e.m365ChatDislike="m365ChatDislike",e.m365ChatLike="m365ChatLike",e.officeintegrationfredialog="officeintegrationfredialog",e.onboardingnotifications="onboardingnotifications",e.selectMediaApi="selectMediaApi",e.selectpeoplepicker="selectpeoplepicker",e.viewImagesApi="viewImagesApi",e.m365ChatReportHarm="m365ChatReportHarm",e.manageapps="manageapps",e.manageappswebhook="manageappswebhook",e.meetingcollaboration="meetingcollaboration",e.meetingcollaborationcontent="meetingcollaborationcontent",e.mediastreams="mediastreams",e.meetinganalytics="meetinganalytics",e.meetingdetails="meetingdetails",e.meetingoptionscreatedialog="meetingoptionscreatedialog",e.meetingrecap="meetingrecap",e.meetingrecaptab="meetingrecaptab",e.meetingroomallinone="meetingroomallinone",e.meetingroomallinonecall="meetingroomallinonecall",e.meetingroomconsolecall="meetingroomconsolecall",e.meetingroomfrontofroom="meetingroomfrontofroom",e.meetingroomfrontofroomcontent="meetingroomfrontofroomcontent",e.meetingroomfrontofroomgallery="meetingroomfrontofroomgallery",e.meet="meet",e.meetingapis="meetingapis",e.meetings="meetings",e.meetingsettings="meetingsettings",e.meetingstream="meetingstream",e.meshavatar="meshavatar",e.messagedraft="messagedraft",e.messages="messages",e.memenu="memenu",e.campaignnotifications="campaignnotifications",e.updatemsaprofileavatardialog="updatemsaprofileavatardialog",e.updatemsaprofilenamedialog="updatemsaprofilenamedialog",e.notes="notes",e.oauthcode="oauthcode",e.open3sfeedback="open3sfeedback",e.openfeedbackdialog="openfeedbackdialog",e.optionssettingsdialog="optionssettingsdialog",e.pstncallmedialog="pstncallmedialog",e.pearnotdefaultapp="pearnotdefaultapp",e.peopleapp="peopleapp",e.pinnedchatsmaxreached="pinnedchatsmaxreached",e.pinnedconversationitems="pinnedconversationitems",e.pinunpinpost="pinunpinpost",e.platformapp="platformapp",e.platformsubscriptionplans="platformsubscriptionplans",e.platformappdetails="platformappdetails",e.platformappconsent="platformappconsent",e.platformappdevicepermissions="platformappdevicepermissions",e.platformtab="platformtab",e.platformapps="platformapps",e.stagedapps="stagedapps",e.platformauthconsentdialog="platformauthconsentdialog",e.platformStage="platformStage",e.platformstageinactivemeeting="platformstageinactivemeeting",e.platformstagemodal="platformstagemodal",e.platformTabGallery="platformTabGallery",e.prejoinoverlaydialog="prejoinoverlaydialog",e.presentdeeplinknomeetingcontextdialog="presentdeeplinknomeetingcontextdialog",e.presentertoolbar="presentertoolbar",e.ptzextension="ptzextension",e.queues="queues",e.registration="registration",e.removechannelemail="removechannelemail",e.removechatuser="removechatuser",e.reportConcern="reportConcern",e.forwardMessage="forwardMessage",e.reportconcerncommunities="reportconcerncommunities",e.reportConcernForTFW="reportConcernForTFW",e.restartrecomendeddialog="restartrecomendeddialog",e.restorechannel="restorechannel",e.restorechannelreactdialog="restorechannelreactdialog",e.restoreteam="restoreteam",e.roomremote="roomremote",e.roster="roster",e.schedulingform="schedulingform",e.schoolteams="schoolteams",e.hwctaskmodule="hwctaskmodule",e.search="search",e.settingsdialog="settingsdialog",e.settingsstore="settingsstore",e.settingsstorecallqueue="settingsstorecallqueue",e.settingsstoredelegator="settingsstoredelegator",e.sharechannelwithuserdialog="sharechannelwithuserdialog",e.sharedchannelspendinginvites="sharedchannelspendinginvites",e.sharedchannelacceptinvitation="sharedchannelacceptinvitation",e.sharedchanneldeclineinvitation="sharedchanneldeclineinvitation",e.sharedchanneldenyinvitation="sharedchanneldenyinvitation",e.sharewithteamyouowndialog="sharewithteamyouowndialog",e.sharedchannelcreateinvitationsdialog="sharedchannelcreateinvitationsdialog",e.sharechatlink="sharechatlink",e.sharecommunitieslink="sharecommunitieslink",e.shareformdialog="shareformdialog",e.shareMeetingInfo="shareMeetingInfo",e.showChannelOwners="showChannelOwners",e.showformemberdialog="showformemberdialog",e.signoutdialog="signoutdialog",e.smartdeviceagendapage="smartdeviceagendapage",e.smartdevicelogin="smartdevicelogin",e.smartdevicelogoutdialog="smartdevicelogoutdialog",e.standaloneapp="standaloneapp",e.stagecontent="stagecontent",e.stagingroomstartmeetingconfirmationdialog="stagingroomstartmeetingconfirmationdialog",e.stopsharingchannelwithteam="stopsharingchannelwithteam",e.stopsharingchannelwithteamreactdialog="stopsharingchannelwithteamreactdialog",e.store="store",e.storefre="storefre",e.streamcamera="streamcamera",e.streamcamerainchannels="streamcamerainchannels",e.streamcameraincommunities="streamcameraincommunities",e.survey="survey",e.tabapps="tabapps",e.taskmodule="taskmodule",e.teamarchive="teamarchive",e.teamanalytics="teamanalytics",e.teamchannels="teamchannels",e.teamcreate="teamcreate",e.teamdeeplink="teamdeeplink",e.teamdiscover="teamdiscover",e.teamedit="teamedit",e.teamsgallery="teamsgallery",e.teamjoin="teamjoin",e.teamjoincode="teamjoincode",e.teamjoindialog="teamjoindialog",e.teamleave="teamleave",e.teammanage="teammanage",e.teammanageapps="teammanageapps",e.teammanagetags="teammanagetags",e.teampendingrequests="teampendingrequests",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teamrestore="teamrestore",e.teams="teams",e.teamserrordialog="teamserrordialog",e.teamslist="teamslist",e.teamsettings="teamsettings",e.tflfre="tflfre",e.toasts="toasts",e.tpndialog="tpndialog",e.transcript="transcript",e.transcriptcontent="transcriptcontent",e.transcripttab="transcripttab",e.translationfeedback="translationfeedback",e.twowaysmsfriendlyname="twowaysmsfriendlyname",e.unparkcalldialog="unparkcalldialog",e.unifiedconsentdialog="unifiedconsentdialog",e.unsupporteddeeplinkdialog="unsupporteddeeplinkdialog",e.updatedesktopapp="updatedesktopapp",e.updategroupchatavatar="updategroupchatavatar",e.tfwupdategroupchatavatar="tfwupdategroupchatavatar",e.usermediadialog="usermediadialog",e.videobackgrounds="videobackgrounds",e.stylemyroom="stylemyroom",e.videoeffectsandavatar="videoeffectsandavatar",e.videoeffectscustomization="videoeffectscustomization",e.videoeffectsmoreview="videoeffectsmoreview",e.virtualevents="virtualevents",e.voiceenrollment="voiceenrollment",e.whatsnewdialog="whatsnewdialog",e.wiki="wiki",e.windowingerrordialog="windowingerrordialog",e.workflows="workflows",e.yammerqna="yammerqna"}(r||(r={}))},635424:(e,t,a)=>{var n,r;a.d(t,{EJ:()=>n,f_:()=>r}),function(e){e.AiInsightsFeedbackService="AiInsightsFeedbackService",e.AppService="appservice",e.AMS="asyncMediaService",e.Attendee="attendee",e.AllFiles="allFiles",e.Auth="auth",e.BRB="brb",e.CDN="cdn",e.ChannelNotificationSettings="channelNotificationSettings",e.CognitiveService="cognitiveService",e.ChatService="chatservice",e.CMDArtifactsService="cmdArtifactsService",e.CmdMeetingIntelligenceService="cmdMeetingIntelligenceService",e.CMDServices="cmdServices",e.CNS="cns",e.CollabCloudService="collabCloudService",e.CSA="csa",e.CXCS="cxcs",e.DynamicsMarketing="dynamicsMarketing",e.DynamicsVirtualEvents="dynamicsVirtualEvents",e.ECS="ecs",e.Graph="graph",e.GroupsServiceV2="groupsServiceV2",e.InstantAnswers="instantanswers",e.LokiWrapper="lokiWrapper",e.MeetingArtifacts="meetingArtifacts",e.MeetingIntelligenceService="meetingIntelligenceService",e.MeetingRecapService="meetingRecapService",e.MeetingRecapSwa="meetingRecapSwa",e.MeetingTemplates="meetingTemplates",e.MiddleTier="mt",e.MsaContacts="msaContacts",e.MSGraph="msGraph",e.NetworkPing="networkPing",e.OCV="ocv",e.Ocws="ocws",e.ODS="ods",e.OSearch="osearch",e.Payment="payment",e.PhonelinkSmsService="phonelinkSmsService",e.PowerApps="powerapps",e.PPTCast="pptcast",e.Sharepoint="sharepoint",e.Skype="skype",e.Substrate="substrate",e.Suggestion="suggestion",e.TAMS="teamsAdminService",e.TeamsAndChannelsProvisioningService="teamsAndChannelsProvisioningService",e.TeamsPushService="teamsPushService",e.Tenants="tenants",e.UnifiedConsent="unifiedConsent",e.UnifiedPresence="unifiedPresence",e.UserEntitlement="ues",e.VivaInsights="vivaInsights",e.Vroom="vroom",e.Webinar="webinar",e.Workflows="workflows",e.VivaInsightsMT="vivaInsightsMt"}(n||(n={})),function(e){e.xMsClientType="x-ms-client-type",e.xMsClientVersion="x-ms-client-version",e.xMsSessionId="x-ms-session-id",e.xMsRequestId="x-ms-request-id",e.xMsClientCaller="x-ms-client-caller"}(r||(r={}))},615465:(e,t,a)=>{var n;a.d(t,{s:()=>n}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(n||(n={}))},291433:(e,t,a)=>{var n;a.d(t,{x:()=>n}),function(e){e[e.Perf=0]="Perf",e[e.Scenario=1]="Scenario",e[e.Logging=2]="Logging",e[e.Heartbeat=3]="Heartbeat",e[e.Http=4]="Http",e[e.UserBI=5]="UserBI",e[e.Endpoint=6]="Endpoint",e[e.ClickStream=7]="ClickStream"}(n||(n={}))},853067:(e,t,a)=>{var n;a.d(t,{hy:()=>n}),function(e){e.default="default",e.skypeConCore="conCore"}(n||(n={}))},437194:(e,t,a)=>{a.d(t,{Hb:()=>h,fb:()=>f});var n=a(65903),r=a(469929),i=a(97600);const o="default",s="CallableChannelOboCall",l="callParkService",c=e=>"twoParty"===e?n.BdF.TwoParty:"multiParty"===e?n.BdF.MultiParty:n.BdF.Unknown,d=e=>{switch(e){case"default":return n.FTP.Default;case"screenSharing":case"ScreenSharing":return n.FTP.ScreenSharing;case"emergencyGroupCall":return n.FTP.EmergencyGroupCall;default:return n.FTP.Unknown}},m=e=>e?Object.assign(Object.assign({},e),{type:e.type||o}):void 0,p={__typename:"CallLogParticipant",displayName:"Unknown",id:"28:unknown",type:o},g=(e,t)=>{var a;if(!e)return"";const n='value="',r=null===(a=e.find((e=>e.indexOf(t)>=0)))||void 0===a?void 0:a.match(/value="(.*?)"/g);return r?r[0].substr(n.length,r[0].length-n.length-1):""},u=(e,t,a,n,i)=>{let o,s,l,c,d=(new Date).toISOString();if(i===r.Cs.CallTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,a);if(!t)return;o=t.callId,s=t.userParticipantId,l=t.transcriptMsg}else if(i===r.Cs.CallLogTranscript){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:a,UserParticipantId:n,ThreadId:r,MessageId:i}=e;return{callId:a,userParticipantId:n,transcriptMsg:{linkedMessage:{conversationId:r,messageId:i}}}}catch(t){return void e.error("failed to parse transcription content.",t)}})(e,a);if(!t)return;o=t.callId,s=t.userParticipantId,l=t.transcriptMsg}else if(i===r.Cs.CallLogRecording){const t=((e,t)=>{if(t)try{const e=JSON.parse(unescape(t.replace(/\u200b|\\/g,""))),{CallId:a,UserParticipantId:n,ThreadId:r,MessageId:i}=e;return{callId:a,userParticipantId:n,recordingMsg:{linkedMessage:{conversationId:r,messageId:i}}}}catch(t){return void e.error("failed to parse recording message content.",t)}})(e,a);if(!t)return;o=t.callId,s=t.userParticipantId,c=t.recordingMsg}else if(i===r.Cs.CallRecording){const e=((e,t)=>{if(!e)return;const a=e.match(/<.*?>/g),n=g(a,'<Id type="callId"'),i=g(a,'<Id type="OriginatorParticipantId"'),o=g(a,"<RecordingInitiatorId ");return{callId:n,userParticipantId:i,recordingMsg:{conversationId:r.wS,messageId:t||"",initiatorId:o,content:e}}})(a,n);if(!e)return;o=e.callId,s=e.userParticipantId,c=e.recordingMsg}else o=t.callId,s=null==t?void 0:t.userParticipantId,d=t.startTime;return{callId:null!=o?o:"",userParticipantId:s,transcript:l,recordings:c&&[c],startTime:null!=d?d:""}},h=(e,t,a,r,i,s,l)=>{var g;if(w(t,a))return;const h=s.newLogger("CallHistoryHelper");try{const a=N(t),{callDirection:s,callState:w,callType:_,connectTime:O,endTime:k,isDeleted:A,messageId:P,originatorParticipant:D,participantList:U,sessionType:F,sharedCorrelationId:M,targetParticipant:L,threadId:x,spamProperties:B,callAttributes:V,forwardingInfo:W,transferInfo:H,sharedLineAppearanceParticipantList:j,targetDelegator:G}=a,z=R(a),$=u(h,a,i,e,r);if(!$)return;let q=m(D);q||(q=p,h.warn(`Could not parse valid participant from ${t}`));const J=(e=>{switch(e){case"missed":return n.Qv1.Missed;case"accepted":return n.Qv1.Accepted;case"declined":return n.Qv1.Declined;case"acceptedElsewhere":return n.Qv1.AcceptedElsewhere;default:return n.Qv1.Unknown}})(w),Q=(e=>"incoming"===e?n.kwT.Incoming:"outgoing"===e?n.kwT.Outgoing:n.kwT.Unknown)(s),K=E(U,null==L?void 0:L.type,null==D?void 0:D.type,null===(g=null==V?void 0:V.transferor)||void 0===g?void 0:g.type,null==H?void 0:H.parkType),Y=S(h,a),{validTargetParticipant:X,forwarderParticipant:Z,forwardedTargetParticipant:ee}=v(J,L,W,V,l,!!Y.isSharedLineAppearanceActivated,G),{transferorParticipant:te,transferTargetParticipant:ae}=y(V,H,K);return Object.assign(Object.assign(Object.assign(Object.assign({applicationContent:z&&(f=z,{type:f.type,configId:f.configId,onBehalfOf:f.onBehalfOf&&Object.assign(Object.assign({},f.onBehalfOf),{type:o}),details:f.details&&Object.assign(Object.assign({},f.details),{type:o})}),callDirection:Q,callState:J,callType:c(_),connectTime:O,endTime:k,isDeleted:A,messageId:P,originatorParticipant:q,participantList:U?U.map(m):[],targetParticipant:X,threadId:x,sessionType:d(F),sharedCorrelationId:null!=M?M:"",spamRiskLevel:B?B.riskLevel:null},$),{transferorParticipant:te,transferTargetParticipant:ae,transferTime:null==H?void 0:H.transferTime,transferStatus:(null==H?void 0:H.transferStatus)&&I(H.transferStatus),forwarderParticipant:Z,forwardedTargetParticipant:ee,forwardedTargetType:b(null==W?void 0:W.forwardingDestinationType),forwardingType:C(null==W?void 0:W.forwardingType)}),l?T(h,a):Y),{sharedLineAppearanceParticipantList:j?j.map(m):[]})}catch(e){h.warn(`UnhandledException in message transformation: ${e}`)}var f},f=e=>{const t={callHistoryInput:void 0,isSlaCallHistory:!1};return e&&(e["sla-call-history"]?(t.callHistoryInput=e["sla-call-history"],t.isSlaCallHistory=!0):e["call-log"]&&(t.callHistoryInput=e["call-log"])),t},v=(e,t,a,r,i,o,s)=>{let l,c,d=t&&m(t);return e===n.Qv1.Accepted&&(null==a?void 0:a.acceptedBy)&&(l=i?s&&m(s):d,d=m(a.acceptedBy)),(null==r?void 0:r.forwardedFrom)&&(l=m(r.forwardedFrom)),(e===n.Qv1.AcceptedElsewhere||i||o)&&(null==a?void 0:a.acceptedBy)&&(c=m(a.acceptedBy)),(null==r?void 0:r.delegator)&&(l=m(r.delegator)),{validTargetParticipant:d,forwarderParticipant:l,forwardedTargetParticipant:c}},y=(e,t,a)=>{let n,r;return a||((null==e?void 0:e.transferor)&&(n=m(e.transferor)),(null==t?void 0:t.transferor)&&(n=m(t.transferor)),(null==t?void 0:t.transferTarget)&&(r=m(t.transferTarget))),{transferorParticipant:n,transferTargetParticipant:r}},I=e=>{switch(e){case"transferred":return n.hyV.Transferred;case"transferAccepted":return n.hyV.TransferAccepted;case"transferFailed":return n.hyV.TransferFailed;case"transferSucceeded":return n.hyV.TransferSucceeded;default:return n.hyV.Unknown}},E=(e,t,a,n,r)=>{const i=r&&"none"!==r&&"Unknown"!==r;return i||i&&!!(null==e?void 0:e.find((e=>e.type&&e.type===l)))||t===l||a===l||n===l},C=e=>{switch(e){case"immediate":return n.Io1.Immediate;case"simultaneous":return n.Io1.Simultaneous;default:return}},b=e=>{switch(e){case"user":return n.Ryo.SingleTarget;case"group":return n.Ryo.Group;case"delegates":return n.Ryo.MyDelegates;case"voicemail":return n.Ryo.Voicemail;default:return}},T=(e,t)=>{const{sharedLineAppearanceForwardType:a,originatorDelegator:n,targetDelegator:r}=t;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{isSharedLineAppearanceCallHistory:!0,forwardingType:C(a),originatorDelegator:n&&m(n),targetDelegator:r&&m(r)}},S=(e,t)=>{var a;const{callAttributes:n,forwardingInfo:r,sharedLineAppearanceActivated:o}=t,s=(null===(a=null==n?void 0:n.onBehalfOf)||void 0===a?void 0:a.id)&&(0,i.lp)(n.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(o||(null==n?void 0:n.delegator)||s||"delegates"===(null==r?void 0:r.forwardingDestinationType)),originatorDelegator:s&&(null==n?void 0:n.onBehalfOf)?m(n.onBehalfOf):void 0,targetDelegator:(null==n?void 0:n.delegator)?m(n.delegator):void 0}},w=(e,t)=>void 0===t?!e:t!==r.wS,N=e=>e?JSON.parse(e):{},R=e=>{var t,a,n;const{applicationContent:r,callAttributes:i,onBehalfOfContext:o}=e;let l;return l=o&&!r?{type:s,configId:o.id||"",onBehalfOf:{type:(null===(t=null==i?void 0:i.onBehalfOf)||void 0===t?void 0:t.type)||s,id:(null===(a=null==i?void 0:i.onBehalfOf)||void 0===a?void 0:a.id)||"",displayName:(null===(n=null==i?void 0:i.onBehalfOf)||void 0===n?void 0:n.displayName)||""}}:r,l}},258248:(e,t,a)=>{a.d(t,{N:()=>r,n:()=>i});var n=a(65903);const r=e=>{if(e)switch(e){default:case"Success":return n.OQk.Success;case"SendFailure":return n.OQk.SendFailure;case"SendFailureCanRetry":return n.OQk.SendFailureCanRetry;case"EditFailure":return n.OQk.EditFailure;case"EditFailureCanRetry":return n.OQk.EditFailureCanRetry;case"DeleteSingleFailure":return n.OQk.DeleteSingleFailure;case"DeleteSingleFailureCanRetry":return n.OQk.DeleteSingleFailureCanRetry;case"DeleteAllFailure":return n.OQk.DeleteAllFailure;case"DeleteAllFailureCanRetry":return n.OQk.DeleteAllFailureCanRetry}},i=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e))},761734:(e,t,a)=>{a.d(t,{Ew:()=>r,aw:()=>i,Hu:()=>o});var n=a(469929);function r(e){const t=[n.Cs.AddMember,n.Cs.Call,n.Cs.CallRecording,n.Cs.CallTranscript];return!!e&&(t.indexOf(e.messageType)>=0||function(e){return!!e.deleteTime}(e))}function i(e,t){var a;return!!(null===(a=null==e?void 0:e.mentions)||void 0===a?void 0:a.some((e=>e.userId===t)))}const o=(e,t)=>{var a;return(null==e?void 0:e.from)!==t&&!!(null===(a=null==e?void 0:e.mentions)||void 0===a?void 0:a.some((e=>"everyone"===e.mentionType)))}},895961:(e,t,a)=>{a.d(t,{w:()=>o});var n=a(786884),r=a(471285),i=a(197981);const o=e=>{const{scheduledMeetingInfo:t}=e,a=s(t);if(a.length)throw(0,n.Tr)(r.w5.DataLayerClient,r.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${a.join(", ")}`);return e},s=e=>{if(!e)return[];const t="meeting.scheduledMeetingInfo";let a=d(e,["startTime","endTime","eventType"],t);const{eventRecurrenceRange:n,eventRecurrencePattern:r}=e;return a=[...a,...l(n,t),...c(r,t)],a},l=(e,t)=>d(e,["startDate"],`${t}.eventRecurrenceRange`),c=(e,t)=>{let a=[];if(e){const{daily:n,weekly:r,monthly:o,yearly:s,relativeMonthly:l,relativeYearly:c}=e;a=[...d(e,["patternType"],`${t}.eventRecurrencePattern`),...d(n,["interval"],`${t}.eventRecurrencePattern.daily`),...d(r,["interval","daysOfTheWeek"],`${t}.eventRecurrencePattern.weekly`),...d(o,["interval","dayOfMonth"],`${t}.eventRecurrencePattern.monthly`),...d(s,["month","dayOfTheMonth"],`${t}.eventRecurrencePattern.yearly`),...d(l,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeMonthly`),...d(c,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${t}.eventRecurrencePattern.relativeYearly`)],r&&r.daysOfTheWeek&&r.daysOfTheWeek.some((e=>(0,i.isNil)(e)))&&a.push(`${t}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return a},d=(e,t,a)=>{const n=[];return(0,i.isNil)(e)||t.forEach((t=>{(0,i.isNil)(e[t])&&n.push(`${a}.${t}`)})),n}},379720:(e,t,a)=>{a.d(t,{wU:()=>o,jY:()=>s,gy:()=>l});var n,r,i=a(65903);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(n||(n={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(r||(r={}));const o=e=>l(e)===i.Ntc.Important,s=e=>r[e]||r.Standard,l=e=>{switch(e){case r.Important:case n.Important:return i.Ntc.Important;case r.Urgent:case n.Urgent:return i.Ntc.Urgent;case r.Standard:case n.Standard:default:return i.Ntc.Standard}}},310070:(e,t,a)=>{a.d(t,{I:()=>n,s:()=>r});const n=1209600,r=.5},991161:(e,t,a)=>{a.d(t,{xV:()=>o,Hs:()=>s,bf:()=>l,zA:()=>c,BU:()=>d});var n=a(197981),r=a(97600),i=a(469929);const o=e=>{var t;const a=l(e),r=d(e);let i=e.lastMessageTimeUtc;if((0,n.isNil)(i)){const a=null===(t=e.lastMessage)||void 0===t?void 0:t.originalarrivaltime;i=a&&new Date(a).getTime()||0}return i<=a.originalArrivalTime&&0===r.originalArrivalTime},s=(e,t)=>{let a="";e.lastMessage&&((0,r.gs)(e.lastMessage)?a=m(e.lastMessage)||"":e.lastMessage.from&&(a=(0,n.last)(e.lastMessage.from.split("/"))||""));const i=d(e);return o(e)||-1!==a.indexOf(t)&&0===i.originalArrivalTime},l=e=>p(e.properties&&e.properties[i.Ff.ConsumptionHorizon]||i.Mp),c=e=>(null==e?void 0:e.userConsumptionHorizon)||(null==e?void 0:e.consumptionHorizonBookmark)||null,d=e=>p(c(e.properties)||i.Mp),m=e=>{let t="";if((0,r.gs)(e)&&e.content){const a=e.content.match(/<initiator>(.*?)<\/initiator>/i);a&&a[1]&&(t=a[1].trim())}return t};function p(e){const[t,a,r]=function(e){const t=3,a=e.split(";");return a&&a.length===t&&a[0]&&!isNaN(Number(a[0]))&&a[1]&&!isNaN(Number(a[1]))&&a[2]&&!(0,n.isNil)(Number(a[2]))?a:i.Mp.split(";")}(e),o=Number(a)||0;return{originalArrivalTime:Number(t)||0,timeStamp:o,clientMessageId:r}}},622419:(e,t,a)=>{a.d(t,{t:()=>h});var n=a(76672),r=a(469929);const i=/^([^(（]+)[(（]?/;function o(e,t){const a=function(e){var t,a,n;let r="";if(!(null==e?void 0:e.displayName))return r;const o=null!==(t=e.displayName)&&void 0!==t?t:"",s=null!==(a=e.givenName)&&void 0!==a?a:"",l=null!==(n=e.surname)&&void 0!==n?n:"",c=null!==s&&o.startsWith(s),d=null!==l&&o.startsWith(l);if(null!==s&&c&&!d)r=s;else if(d&&!c){const e=i.exec(o);e&&e.length>1&&(r=e[1].trim())}return r=r||o,r||""}(t);return a||(e?e.split(" ")[0]:"")}var s=a(47135),l=a(615465),c=a(97600),d=a(490503),m=a(182302);const p=(e,t,a)=>{const{enableGroupChatInviteFlow:n}=a.get(s.J.Messaging),r=(0,m.rh)(e);return!!n&&!t&&!r},g=(e,t,a,n,r)=>{var i;if(n)return!1;const o=!!(0,c.eX)(e.id);return((e,t,a)=>{const n=(0,d.Bl)(e);return!(!t||!a||n)})(e.id,a,!!(null===(i=e.usersProps)||void 0===i?void 0:i.hasConsumerUser))||((e,t,a,n,r)=>{var i;const o=[];null===(i=e.members)||void 0===i||i.forEach((e=>{const t=n[e.id];t&&o.push(t)}));const s=(0,m.C)(o,r);return(0,c._K)(e.id,t,a,!!s.length||t,o.map((e=>e.id)))})(e,o,a,t,r)||(s=e.id,(0,d.Bl)(s));var s};var u=a(399330);const h=e=>{var t,a,i;const{conversation:c,profilesMap:h,coreSettings:f,i18n:v,loggerFactory:y,currentUserMri:I,currentUserTenantId:E,addSenderName:C=!1}=e,b=!!(0,d.YP)(c),T=(0,n.F)(null!==(a=null===(t=null==c?void 0:c.lastMessage)||void 0===t?void 0:t.from)&&void 0!==a?a:""),S=h[T],w=((e,t,a,n,i,o,c)=>{var d;let m;const{environment:u}=a.get(s.J.Metadata),h=u===l.s.life;switch(null===(d=e.properties)||void 0===d?void 0:d.interopconversationstatus){case r.uI.ExtendedDirectoryAcceptPending:m=n.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==c?void 0:c.displayName)||n.stringTranslate("peoplePicker","unknown_user")});break;case r.uI.AcceptPending:m=p(e.id,i,a)||g(e,t,i,h,o)?n.stringTranslate("messaging","tmp_group_chat_invite_flow_chat_list_preview"):n.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:(null==c?void 0:c.displayName)||n.stringTranslate("peoplePicker","unknown_user")});break;case r.uI.Blocked:m=n.stringTranslate("people","blocked_sfc_chat_preview_message")}return m})(c,h,f,v,b,E,S);if(w)return w;const N=c.lastMessage;if(!N){return(0,d.xb)(c.id)?v.stringTranslate("messaging","chats_messageDraftPreview_default"):""}if(null===(i=N.properties)||void 0===i?void 0:i.deletetime)return v.stringTranslate("messaging","chats_messagePreview_lastMessage_deleted");const R=(0,m.DE)(y,N.messagetype,N.properties);let _=function(e,t,a){var n;const i=(null===(n=e.lastMessage)||void 0===n?void 0:n.content)||"";switch(a){case r.Cs.MediaCard:return t.stringTranslate("messaging","chats_messagePreview_sent_a_card");case r.Cs.CallRecording:return"";case r.Cs.AddMember:return t.stringTranslate("messaging","chats_messagePreview_user_added");case r.Cs.CallTranscript:return t.stringTranslate("messaging","chats_messagePreview_call_transcript");case r.Cs.Collaborate:return""}return/^<img\b[^>]*>$/.test(i)?t.stringTranslate("messaging","chats_messagePreview_sent_an_image"):(o=i,/^<video[^>]*>[^<>]*<\/video>$/.test(o)?t.stringTranslate("messaging","chats_messagePreview_sent_an_inline_video"):i);var o}(c,v,R);if(""===_.trim()&&(_=function(e,t,a){const n=(0,m.jz)(a,e.properties),r=(0,m.le)(a,e.properties);return(null==n?void 0:n.length)?t.stringTranslate("messaging","chats_messagePreview_sent_a_file"):(null==r?void 0:r.some((e=>e.contentType===u.s.Audio)))?t.stringTranslate("messaging","recent_conversations_sent_an_voice_message"):(null==r?void 0:r.some((e=>"bfb101ece45946be988be560a74322f2"===e.cardClientId)))?t.stringTranslate("messaging","recent_conversations_sent_a_location_message"):""}(N,v,y)),!_)return"";if(!C)return _;const O=T===I,k=function(e,t,a,n,i){if(e===r.Cs.Call||e===r.Cs.AddMember||e===r.Cs.CallRecording||e===r.Cs.CallTranscript||i&&!n)return{key:"chats_messagePreview_withoutDisplayName"};if(n)return{key:"chats_messagePreview_fromSelf"};const s=o(t,a);return s?{key:"chats_messagePreview_withDisplayName",displayName:s}:{key:"chats_messagePreview_withoutDisplayName"}}(R,N.imdisplayname,S,O,!!b);return _=v.stringTranslate("messaging",k.key,{message:_,displayName:k.displayName}),_}},660329:(e,t,a)=>{a.d(t,{n:()=>n});const n=(e,t,a)=>{const n=e?parseInt(e,10):null,r=t?new Date(t).getTime():0,i=a?parseInt(a,10):null;return!!(i&&i>=r)||!!n&&!(r&&n<r)}},182302:(e,t,a)=>{a.d(t,{le:()=>c,DE:()=>d,jz:()=>u,rh:()=>h,C:()=>f});var n=a(65903),r=a(297055),i=a(786884),o=a(471285),s=a(197981),l=a(469929);const c=(e,t,a)=>{if(!t||!t.cards||"string"!=typeof t.cards&&!a)return null;try{let e=String(t.cards);a&&(e=a);return JSON.parse(e).map((({appIcon:e,appId:t,appName:a,cardClientId:n,content:r,contentType:i,locale:o,userSpecificContent:s})=>Object.assign({appIcon:e,appId:t||"",appName:a,cardClientId:n,content:JSON.stringify(r),contentType:i,locale:o},!!s&&{userSpecificContent:s})))}catch(t){return e.newLogger("Conversation Last Message Processing").log("UnhandledException in toCards."),null}},d=(e,t,a)=>{if(t===l.Cs.HTML){if(((e,t)=>{const a=c(e,t);if(!a)return!1;const n=(0,s.find)(a,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!n&&!!JSON.parse(n.content).componentUrl})(e,a))return l.Cs.Collaborate;if(((e,t)=>{const a=c(e,t);if(!a)return!1;const n=(0,s.find)(a,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!n&&!!JSON.parse(n.content).componentUrl})(e,a))return l.Cs.Embed}return t};var m;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(m||(m={}));const p=(e,t)=>{try{const t=JSON.parse(e);if(!t||!t.code)return;const a=(e=>{switch(e){case n.mFJ.BOX:return n.mFJ.BOX;case n.mFJ.DROPBOX:return n.mFJ.DROPBOX;case n.mFJ.EGNYTE:return n.mFJ.EGNYTE;case n.mFJ.GOOGLEDRIVE:return n.mFJ.GOOGLEDRIVE;case n.mFJ.SHAREFILE:return n.mFJ.SHAREFILE;default:throw new Error("Invalid provider code")}})(t.code);return{code:a,type:(e=>{switch(e){case m.Sharepoint:return n.RWp.Sharepoint;case m.WOPI:return n.RWp.WOPI;case m.Google:return n.RWp.Google;case m.OneDrive:return n.RWp.OneDrive;case m.Recent:return n.RWp.Recent;case m.Aggregate:return n.RWp.Aggregate;case m.FileSystem:return n.RWp.FileSystem;case m.Search:return n.RWp.Search;case m.AllFiles:return n.RWp.AllFiles;case m.SharedWithMe:return n.RWp.SharedWithMe;default:throw new Error("Not a valid provider type")}})(parseInt(t.type,10))}}catch(e){return void t.newLogger("Chat Helper").log(`UnhandledException in message transformation: ${e}`)}},g=(e,t)=>{{const a=2,s=["http","https"],{filePreview:l,chicletBreadcrumbs:c,fileInfo:d,anchorFileId:m,progressComplete:g,isUploadError:u,fileChicletState:h,providerData:f}=e,{shareUrl:v,shareId:y,itemId:I}=d,E=l||{},C=null==h?void 0:h.serviceName,{id:b,baseUrl:T,objectUrl:S,type:w,title:N,state:R}=((e,t)=>{var a;const{version:n}=e;let{id:r,baseUrl:s,objectUrl:l,type:c,title:d,state:m}=e;if(n!==t&&(({itemid:r,fileName:d,fileType:c,fileInfo:{fileUrl:l,siteUrl:s}}=e),m=null===(a=e.fileChicletState)||void 0===a?void 0:a.state),"string"!=typeof r)throw(0,i.Tr)("ChatHelpers",o.jK.Undefined,"toFiles",{id:r,version:n,type:c},"File id is missing");return{id:r,baseUrl:s,objectUrl:l,type:c,title:d,state:m}})(e,a),_="active"!==R&&"hidden"!==R,O=p(f,t);return Object.assign({id:b,itemId:I,chicletBreadcrumbs:c,baseUrl:(0,r.Nm)(T,s),objectUrl:(0,r.Nm)(S,s),shareId:y,shareUrl:v,type:w,title:N,fileId:b,isReferencedFile:_,anchorFileId:m,progressComplete:g&&parseInt(g,10)||null,serviceName:C&&n.a4b[C],state:R&&n.cj1[R],hasUploadFailed:u,providerDataV2:O},E)}},u=(e,t)=>{if(!t||!t.files||"string"!=typeof t.files)return null;try{let a=JSON.parse(t.files);a=a.filter((e=>"deeplink"!==e.type));return(0,s.map)(a,(t=>g(t,e)))}catch(e){return null}},h=e=>!!e&&e.includes(l.IX),f=(e,t)=>e.filter((({tenantId:e,isFederated:a})=>a||t&&e&&e!==t))},30791:(e,t,a)=>{function n(e){const t=e.startsWith("?")||e.startsWith("#");e=t?e.substring(1):e;const a={};return e.split("&").forEach((e=>{const[t,n]=e.split("=");a[t]=decodeURIComponent((n||"").replace(/^.+?(=)/,""))})),a}a.d(t,{d:()=>n})},399330:(e,t,a)=>{var n;a.d(t,{s:()=>n}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail"}(n||(n={}))},455074:(e,t,a)=>{a.d(t,{zm:()=>n,py:()=>r,WK:()=>i,bW:()=>c,x$:()=>d,Zk:()=>m,OO:()=>p});var n,r,i,o,s,l=a(471285);!function(e){e.logErrorMessage="errorMessage",e.internalErrorCode="errorCode",e.correlationId="correlationId",e.httpStatusCode="httpStatusCode",e.isRecoverable="isRecoverable",e.reportingService="reportingService",e.subError="subError",e.serviceErrorMessage="serviceErrorMessage",e.cmdRequestId="requestId"}(n||(n={})),function(e){e.UNKNOWN_ERROR="UnknownError",e.FORBIDDEN="Forbidden",e.NOT_FOUND="NotFound",e.CONFLICT="Conflict",e.UNAUTHORIZED="Unauthorized",e.BAD_REQUEST="BadRequest",e.INTERNAL_SERVER_ERROR="InternalServerError",e.SERVICE_UNAVAILABLE="ServiceUnavailable",e.REQUEST_THROTTLED="RequestThrottled",e.FAILED_TO_CALL_SCHEDULING_SERVICE="FailedToCallSchedulingService",e.GATEWAY_TIMEOUT="GatewayTimeout",e[e.DEFAULT_ERROR=1e3]="DEFAULT_ERROR",e[e.BEGIN_CLIENT_ERROR_CODES=1001]="BEGIN_CLIENT_ERROR_CODES",e[e.INVALID_RESPONSE=1002]="INVALID_RESPONSE",e[e.CHANGE_KEY_NOT_FOUND=1003]="CHANGE_KEY_NOT_FOUND",e[e.EMPTY_INPUT=1004]="EMPTY_INPUT",e[e.INVALID_SECRET=1005]="INVALID_SECRET",e[e.RENEW_TOKEN_FAILED=1006]="RENEW_TOKEN_FAILED"}(r||(r={})),function(e){e.DEFAULT_BAD_REQUEST="Request is not correct, please ensure you are passing the values for each parameter.",e.DEFAULT_ERROR="Unknown error occurred",e.COLLAB_OBJECT_NOT_FOUND="Collab object could not be found for the provided external entity key",e.RESOURCE_CONFLICT="Resource conflicts with another; location URLs must be unique",e.EMPTY_INPUT="Input is empty",e.INVALID_SECRET="Invalid Secret while trying to commit resource",e.FORBIDDEN="User does not have permissions to access the requested resource",e.INVALID_RESPONSE="Response from CMD Artifact service is not valid.",e.CHANGE_KEY_NOT_FOUND="No change key in collab object returned.",e.UNAUTHORIZED="User does not have permissions to perform the requested action",e.INTERNAL_SERVER_ERROR="An error occurred with Artifacts service",e.SERVICE_UNAVAILABLE="Service is not currently available.",e.REQUEST_THROTTLED="Requests to the artifacts service are being throttled.",e.FAILED_TO_CALL_SCHEDULING_SERVICE="Artifact service was not able to call scheduling service",e.GATEWAY_TIMEOUT="A downstream service is timing out."}(i||(i={})),function(e){e.RESOURCE_CONFLICT="Conflict - Reason: Conflict",e.BAD_REQUEST="Bad Request",e.NOT_FOUND="NotFound - Reason: Not Found",e.FORBIDDEN="Permission Issue"}(o||(o={})),function(e){e.POPUP_BLOCKED="Error opening popup",e.RENEW_TOKEN_FAILED="Token Renewal Failed"}(s||(s={}));const c="Unknown",d="None",m="None",p=(new Map([[s.POPUP_BLOCKED,l.jK.AuthPopupWindowBlocked],[s.RENEW_TOKEN_FAILED,r.RENEW_TOKEN_FAILED]]),new Map([[r.UNKNOWN_ERROR,i.DEFAULT_ERROR],[r.CONFLICT,i.RESOURCE_CONFLICT],[r.NOT_FOUND,i.COLLAB_OBJECT_NOT_FOUND],[r.BAD_REQUEST,i.DEFAULT_BAD_REQUEST],[r.FORBIDDEN,i.FORBIDDEN],[r.UNAUTHORIZED,i.UNAUTHORIZED],[r.INTERNAL_SERVER_ERROR,i.INTERNAL_SERVER_ERROR],[r.SERVICE_UNAVAILABLE,i.SERVICE_UNAVAILABLE],[r.REQUEST_THROTTLED,i.REQUEST_THROTTLED],[r.INVALID_RESPONSE,i.INVALID_RESPONSE],[r.CHANGE_KEY_NOT_FOUND,i.CHANGE_KEY_NOT_FOUND],[r.FAILED_TO_CALL_SCHEDULING_SERVICE,i.FAILED_TO_CALL_SCHEDULING_SERVICE],[r.GATEWAY_TIMEOUT,i.GATEWAY_TIMEOUT]]))},494326:(e,t,a)=>{a.d(t,{D:()=>n});const n=(e,t={},a)=>{let n;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');n=JSON.parse(e)}catch(e){n=t,null==a||a(e)}return n}},86371:(e,t,a)=>{var n;a.d(t,{z:()=>n}),function(e){e.logErrorMessage="logErrorMessage",e.internalErrorCode="internalErrorCode",e.spoInnerErrorCode="spoInnerErrorCode",e.correlationId="correlationId",e.httpCode="httpCode",e.errorCode="errorCode",e.isExpected="isExpected",e.reason="reason",e.serverResponse="serverResponse"}(n||(n={}))},522546:(e,t,a)=>{a.d(t,{E:()=>n});class n{constructor(e,t,a){this.iTUCountryPrefix=t,this.logger=a,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){var t;let a=n.removeFormatCharacters(e);a=n.removeGuid(a);let r=1;for(const n of this.normalizeRules){const{pattern:i,translation:o,isInternalExtension:s}=n;if(i.test(a)){const n=a.replace(i,o);return null===(t=this.logger)||void 0===t||t.log(`[normalize] [${e}] was normalized into [${n}] using rule ${r} of ${this.normalizeRules.length}: ruleExpression=[${i}] translation=[${o}] isInternalExtension=[${s}].`),{phoneNumber:n,isInternalExtension:s,isNormalized:!0}}r++}return{phoneNumber:a}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const t of e)try{this.normalizeRules.push({pattern:new RegExp(t.pattern),translation:t.translation,isInternalExtension:t.isInternalExtension})}catch(e){this.invalidRules.push(t.pattern)}}}},154860:(e,t,a)=>{var n;a.d(t,{a:()=>n}),function(e){e[e.E164=0]="E164",e[e.INTERNATIONAL=1]="INTERNATIONAL",e[e.NATIONAL=2]="NATIONAL"}(n||(n={}))},257401:(e,t,a)=>{a.d(t,{B:()=>o});var n=a(361366);let r;const i=()=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){if(!r){const e=yield Promise.all([a.e(893479),a.e(672617),a.e(239894),a.e(698627),a.e(273621),a.e(302711),a.e(259196),a.e(86052),a.e(867182),a.e(579166),a.e(297875),a.e(499057),a.e(251821),a.e(519986),a.e(181896),a.e(803466),a.e(788347),a.e(623025),a.e(579814),a.e(418676),a.e(730588),a.e(101243),a.e(603612),a.e(998947),a.e(767372),a.e(191280),a.e(815848),a.e(86048),a.e(949856),a.e(29311),a.e(386196),a.e(384848),a.e(674818),a.e(860125),a.e(250255),a.e(118428),a.e(501749),a.e(41547),a.e(991883),a.e(602460),a.e(902140),a.e(569885),a.e(635287),a.e(491448),a.e(463911),a.e(636211),a.e(398949),a.e(797371),a.e(11495),a.e(116707),a.e(47571),a.e(145679),a.e(510017),a.e(237602),a.e(697633),a.e(204735),a.e(196673),a.e(126962),a.e(764175),a.e(327074),a.e(520158),a.e(995377),a.e(447278),a.e(651925),a.e(568740)]).then(a.bind(a,311514));r=new e.PhoneNumberService}return r}));class o{constructor(e,t,a){this.phoneNumberService=e,this.value=t,this.isNormalized=a}static tryParse(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const a=yield i(),{regionCode:n,normalizer:r,convertAlphaCharactersToNumber:s,isMri:l}=t||{},c=o.getUserLocale(n,null==r?void 0:r.getITUCountryPrefix(),a),{phoneNumber:d,extension:m}=o.separateExtension(a,e);let p=d;!0===s&&(p=a.convertAlphaCharactersInNumber(p));const g=null==r?void 0:r.normalize(p),u=null==g?void 0:g.isNormalized,h=(null==g?void 0:g.phoneNumber)||p;try{let e;return e=l?a.parse(`${h}${m}`,c):a.parseAndKeepRawInput(`${h}${m}`,c),new o(a,e,u)}catch(e){return}}))}static isPossibleNumber(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const a=yield i(),n=a.parse(e,o.getUserLocale(void 0,t.getITUCountryPrefix(),a));return a.isPossibleNumber(n)}catch(e){return!1}}))}static isStandardFormatNormalized(e,t,a,r){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(!e)return!1;try{const n=yield i(),s=t.normalize(e),l=n.parse(s.phoneNumber,o.getUserLocale(a,t.getITUCountryPrefix(),n));return n.isPossibleNumber(l)&&(r||n.isValidNumber(l))}catch(e){return!1}}))}static getValidNumber(e,t,a){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return o.isStandardFormatNormalized(e,t,a).then((a=>a?e:e.startsWith("+")?"":o.isStandardFormatNormalized("+".concat(e),t).then((t=>t?`+${e}`:""))))}))}static isValidNumberForAnyRegion(e,t){if(!e)return!1;try{const a=o.getPhoneNumberService(e).getRegionCode(o.getPhoneNumberValue(e));return!!a&&-1!==t.indexOf(a)}catch(e){return!1}}static getPhoneNumberService(e){return e.phoneNumberService}static getPhoneNumberValue(e){return e.value}static getIsNormalized(e){return e.isNormalized}static getUserLocale(e,t,a){if(e)return e;if(!t)return;let n;return t&&(n=a.getRegionCodeForCountryCode(Number(t))),n||(n="us"),n.toLowerCase()}static separateExtension(e,t){const a=t.search(e.getExtensionRegx()),n=a>-1;return{phoneNumber:n?t.substring(0,a):t,extension:n?t.substring(a):""}}}},912825:(e,t,a)=>{function n(e=1){const t=new Uint32Array(e),n=a.g;if(n.msCrypto)n.msCrypto.getRandomValues(t);else if(n.crypto)n.crypto.getRandomValues(t);else{let a=e;for(;a--;){const e=4294967296;t[a]=Math.floor(Math.random()*e)}}return Array.from(t)}a.d(t,{M:()=>n})}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/203932-f2f6edf53c107297.js.map