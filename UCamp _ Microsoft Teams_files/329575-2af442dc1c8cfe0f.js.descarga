"use strict";(this.webpackChunk_msteams_multi_window=this.webpackChunk_msteams_multi_window||[]).push([[329575],{58871:(e,t,i)=>{i.d(t,{S:()=>c});var n=i(361366),r=i(65903);const{OverlayThinHorizontalBar:a,PartialOverlay:o,ThinHorizontalBar:s,TitleBar:d,VerticalBar:l}=r.OQr,c=(0,n.__rest)(r.OQr,["OverlayThinHorizontalBar","PartialOverlay","ThinHorizontalBar","TitleBar","VerticalBar"])},765995:(e,t,i)=>{var n;i.d(t,{y:()=>n}),function(e){e.p720="720p",e.p1080="1080p",e.p2k="2k",e.p4k="4k",e.unkown="unkown"}(n||(n={}))},283202:(e,t,i)=>{i.d(t,{ip:()=>c,Yx:()=>p,MI:()=>u,P3:()=>m,aA:()=>h,Rr:()=>v});var n=i(187203),r=i(853067),a=i(27994),o=i(291433),s=i(31516),d=i(916561);const l="heartbeat";class c{constructor(){this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=()=>this.telemetryProvider.flush(),this.telemetryProvider=(0,n.G)(),(0,a.Y)((()=>{this.initialized=!1,this.eventDecoratorCallbacks=[]}))}get sessionId(){return this.telemetryProvider.sessionId}initialize(e,t){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),this._tablePostfix=t,this.initialized=!0)}static getInstance(){return this.telemetrySender||(this.telemetrySender=new c),this.telemetrySender}registerEventDecorator(e){this.eventDecoratorCallbacks.push(e)}sendTelemetry(e,t,i={},n,a,l,c=""){if(!this.initialized)return;t=t.replace(/\-/g,"_").toLowerCase();const p=`${o.x[e]}${this._tablePostfix}`.toLowerCase(),u=e===o.x.Http?i.resultCode:e===o.x.Endpoint&&i.result&&d.qb[i.result]?d.qb[i.result].toString():e===o.x.Endpoint&&i.hasInnerError?"fail":"success",m=s.H.getInstance().getSampleRate(p,null!=l?l:t,u);if(m===s.k)return;this.decorateEvent(t,i);const h=this.telemetryProvider.createEvent(p,t,i,n,a,l);h.setProperty("sampleRate",m),this.telemetryProvider.logEvent(r.hy.default,h,c)}sendScenarioEvent(e,t,i,n,a,d=""){var l;if(!this.initialized)return;const c=e.replace(/\-/g,"_").toLowerCase(),p=`${o.x[o.x.Scenario]}${this._tablePostfix}`.toLowerCase();let u=s.H.getInstance().getSampleRate(p,c,i["Scenario.Status"]);if("Scenario.CrossClientMode"in t&&(u=null!==(l=s.H.getInstance().getCrossClientScenarioSampleRate(i["Scenario.Mode"]))&&void 0!==l?l:u),u===s.k)return;this.decorateEvent(c,t);const m=Object.assign(Object.assign({},i),t),h=this.telemetryProvider.createEvent(p,e,m,n,a);h.setProperty("sampleRate",u),this.telemetryProvider.logEvent(r.hy.default,h,d)}sendHeartbeatEvent(e){if(!this.initialized)return;const t=`${o.x[o.x.Heartbeat]}${this._tablePostfix}`.toLowerCase();this.decorateEvent(l,e);const i=this.telemetryProvider.createEvent(t,l,e);this.telemetryProvider.logEvent(r.hy.default,i,void 0)}sendLoggingEvent(e,t,i,n,a,d){if(!this.initialized)return;e=e.replace(/\-/g,"_").toLowerCase();const l=`${o.x[o.x.Logging]}${this._tablePostfix}`.toLowerCase(),c=s.H.getInstance().getSampleRate(l,i,t.logLevel);if(c===s.k)return;this.decorateEvent(e,t);const p=this.telemetryProvider.createEvent(l,e,t,a,d,i);p.setProperty("sampleRate",c),this.telemetryProvider.logEvent(r.hy.default,p,n)}decorateEvent(e,t){this.eventDecoratorCallbacks.forEach((i=>i(e,t)))}}function p(e,t,i,n,r,a=""){c.getInstance().sendScenarioEvent(e,t,i,n,r,a)}function u(e,t,i,n,r,a=""){c.getInstance().sendLoggingEvent(e,t,i,a,n,r)}function m(e,t,i,n,r,a,o=""){c.getInstance().sendTelemetry(e,t,i,n,r,a,o)}function h(e){c.getInstance().sendHeartbeatEvent(e)}function v(e){c.getInstance().registerEventDecorator(e)}},65274:(e,t,i)=>{i.d(t,{K:()=>S});var n=i(361366),r=i(765995);const a=2073600,o=3686400,s=8294400;function d(e){var t,i,d;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n={Perf_Screen:void 0};let l;const c=e.screen.availWidth*(null===(t=e.screen)||void 0===t?void 0:t.availHeight);return l=c<a?r.y.p720:c>=a&&c<o?r.y.p1080:c>=o&&c<s?r.y.p2k:c>=s?r.y.p4k:r.y.unkown,n.Perf_Screen={width:null===(i=e.screen)||void 0===i?void 0:i.availWidth,height:null===(d=e.screen)||void 0===d?void 0:d.availHeight,resolution:l,dpr:e.devicePixelRatio},Promise.resolve(n)}))}var l=i(47135),c=i(471285),p=i(902481),u=i(283202),m=i(487722),h=i(945607),v=i(694065),f=i(197981);class g{constructor(e,t){this.hostCommunicationService=t,this.uuidToAppIdMap={},this.cmsObjects=[],this.logger=e.newLogger("PlatformAppsManagementService")}getTelemetry(e){return this.getPlatformAppsStats(e)}getAppsPerfMetrics(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.hostCommunicationService){const e=yield(0,h.K)(this.hostCommunicationService,!0);return this.getPlatformAppsStats(e,!0)}}))}addCacheManagementService(e){var t,i;return this.cmsObjects.find((t=>t===e))?(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"addCacheManagementService: cms exists in appManagementService","platform_app_caching_cms_exists_in_app_management_service",void 0,!0),!1):(this.cmsObjects.push(e),!0)}removeCacheManagementService(e){return this.cmsObjects.splice(this.cmsObjects.indexOf(e),1),!0}addApp(e,t,i){var n,r;return this.uuidToAppIdMap.hasOwnProperty(e)?(null===(r=(n=this.logger).errorToTelemetry)||void 0===r||r.call(n,"addApp: App exists in appManagementService","platform_app_exists_in_app_management_service",{"App.Id":t},!0),!1):(this.uuidToAppIdMap[e]={appId:t,managedByCache:i},!0)}removeApp(e){var t,i;return this.uuidToAppIdMap[e]?(delete this.uuidToAppIdMap[e],!0):(null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"removeApp: App is not in uuid map","platform_app_missing_in_uuid_map",void 0,!0),!1)}findProcessInfo(e,t){if(!t)return;const i=e.processes.find((e=>e.processId===t));return i?{workingSetSize:i.workingSetSizeKB,commitSize:i.commitSizeKB,cpuCycleTime:i.cpuCycleTime}:void 0}computeSizeOfFrames(e){const{memoryMetrics:t,processVisitedMap:i,isActiveApp:n,appsStats:r,perAppData:a,frames:o,treeLevel:s}=e;for(const d of o){const o=this.findProcessInfo(t,d.processId);if(!o)return;const l=o.workingSetSize||0,c=o.commitSize||0;d.processId&&!i[d.processId]&&(i[d.processId]=d,this.addAppStatsInfo(n,l,c,r)),a.totalWorkingSetSizeKB+=l,a.totalCommitSizeKB+=c,a.maxCpuCycleTime=Math.max(a.maxCpuCycleTime,o.cpuCycleTime),d.platformFrameUuid&&(n?r.activeAppsCount+=1:r.cachedAppsCount+=1),a.frameInfo.push({processId:d.processId,workingSetSizeKB:o.workingSetSize,cpuCycleTime:o.cpuCycleTime,treeLevel:s}),this.computeSizeOfFrames(Object.assign(Object.assign({},e),{frames:d.frames,treeLevel:s+1}))}}isActiveApp(e){let t=!1;for(const i of this.cmsObjects)if(t=i.isAppActive(e),t)break;return t}getPlatformAppsStats(e,t){const i={activeWorkingSetSizeKB:0,cachedWorkingSetSizeKB:0,activeCommitSizeKB:0,cachedCommitSizeKB:0,activeAppsCount:0,cachedAppsCount:0,appsPlatformStats:[]},n={windows:e.windows,processVisitedMap:{},memoryMetrics:e,appsStats:i,includeFrameUuid:t};return this.processMemoryInformation(Object.assign(Object.assign({},n),{computeActiveApps:!0})),this.processMemoryInformation(Object.assign(Object.assign({},n),{computeActiveApps:!1})),i}addAppStatsInfo(e,t,i,n){e?(n.activeWorkingSetSizeKB+=t,n.activeCommitSizeKB+=i):(n.cachedWorkingSetSizeKB+=t,n.cachedCommitSizeKB+=i)}processMemoryInformation(e){var t;const{windows:i,computeActiveApps:n,appsStats:r,memoryMetrics:a,processVisitedMap:o,includeFrameUuid:s}=e;for(const e of i)for(const i of e.frames){if(!i.platformFrameUuid)continue;const d=this.uuidToAppIdMap[i.platformFrameUuid],l=!(null==d?void 0:d.managedByCache)||this.isActiveApp(i.platformFrameUuid);if(l===!n)continue;const c={windowId:e.windowId,isCached:!l,totalWorkingSetSizeKB:0,totalCommitSizeKB:0,maxCpuCycleTime:0,frameInfo:[],appId:null!==(t=null==d?void 0:d.appId)&&void 0!==t?t:"",platformFrameUuid:s?i.platformFrameUuid:void 0};this.computeSizeOfFrames({frames:[i],appsStats:r,memoryMetrics:a,perAppData:c,isActiveApp:l,processVisitedMap:o,treeLevel:0}),r.appsPlatformStats.push(c)}}}class S{constructor(e){this.context=e,this.isRunning=!1,this.timeouts={},this.granularNativeMetrics=[],this.granularWorkerMetrics=[],this.packedCallingData=new Map,this.peakWorkingSetByProcess=new Map,this.peakUsedJSHeapSize=0,this.granularJSHeapMetrics=[],this.getHeartbeatInterval=()=>{var e,t;return null!==(t=null===(e=this._configuration)||void 0===e?void 0:e.intervalInSeconds)&&void 0!==t?t:Number.MAX_SAFE_INTEGER},this.getMemorySubInterval=()=>{var e,t;return null!==(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection.collectionIntervalInSeconds)&&void 0!==t?t:Number.MAX_SAFE_INTEGER},this.logger=e.loggerFactory.newLogger("Heartbeat"),this.platformAppsManagementService=new g(e.loggerFactory,e.hostCommunicationService)}static getInstance(){return S.instance}get configuration(){return this._configuration}getPlatformAppsService(){return this.platformAppsManagementService}start(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){S.instance||(S.instance=this,this.logger.debug("Starting the monitor..."),this.subscribeToCoreSettings(),this.initializedTime=(new Date).getTime(),yield this.registerScenarios())}))}isHeartbeatMonitorRunning(){return this.isRunning}getMemoryData(){var e,t;return(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)?this.getAverageMemoryMetrics():{}}collectData(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=this.getActions().map((e=>e()));return Object.assign.apply(Object,yield Promise.all(e))}))}collectCallingData(e,t){var i,n;const{enableCallingCDLTrackingNS:r}=this.context.coreSettings.get(l.J.Calling)||{};if(r){const e=JSON.parse(t),n={cdlData:null===(i=this.context.graphqlOpsCountService)||void 0===i?void 0:i.getLatestDataAndClear()},r=Object.assign(e,n);t=JSON.stringify(r)}this.packedCallingData.set(e,(null!==(n=this.packedCallingData.get(e))&&void 0!==n?n:[]).concat(t))}getActions(){var e,t,i,n,r,a,o,s,c,p,u,m,h,v,f,g,S,k,y,b,C,P,T;const I=[];(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.memoryMetricsCollection)||void 0===t?void 0:t.enabled)&&I.push(this.getAverageMemoryMetrics.bind(this)),(null===(n=null===(i=this._configuration)||void 0===i?void 0:i.elapsedTimeTracking)||void 0===n?void 0:n.enabled)&&I.push(this.getElapsedTime.bind(this)),(null===(a=null===(r=this._configuration)||void 0===r?void 0:r.screenInfoCollection)||void 0===a?void 0:a.enabled)&&I.push(d.bind(this,this.context.windowProvider)),(null===(s=null===(o=this._configuration)||void 0===o?void 0:o.ariMetricsCollection)||void 0===s?void 0:s.enabled)&&I.push(this.getAriMetrics.bind(this)),(null===(p=null===(c=this._configuration)||void 0===c?void 0:c.dataClientMetricsCollection)||void 0===p?void 0:p.enabled)&&I.push(this.getDataClientMetrics.bind(this)),(null===(m=null===(u=this._configuration)||void 0===u?void 0:u.windowMetricsCollection)||void 0===m?void 0:m.enabled)&&I.push(this.getWindowMetrics.bind(this)),(null===(v=null===(h=this._configuration)||void 0===h?void 0:h.clientStateMetricsCollection)||void 0===v?void 0:v.enabled)&&I.push(this.getClientStateMetrics.bind(this)),(null===(g=null===(f=this._configuration)||void 0===f?void 0:f.OLDMetricsCollection)||void 0===g?void 0:g.enabled)&&I.push(this.getObjectLeakDetectorMetrics.bind(this));const{enableCallingDataCollectionInHeartbeatConfig:_}=(null===(S=this.context.coreSettings)||void 0===S?void 0:S.get(l.J.Calling))||{};return _&&(null===(y=null===(k=this._configuration)||void 0===k?void 0:k.callingDataCollection)||void 0===y?void 0:y.enabled)&&I.push(this.getCallingData.bind(this)),(null===(C=null===(b=this._configuration)||void 0===b?void 0:b.graphqlStoreMetricsCollection)||void 0===C?void 0:C.enabled)&&I.push(this.getGraphQLStoreMetrics.bind(this)),(null===(T=null===(P=this._configuration)||void 0===P?void 0:P.platformAppMetricsCollection)||void 0===T?void 0:T.enabled)&&I.push(this.getPlatformAppsMetrics.bind(this)),I}stopHeartbeat(){this.isRunning&&this.logger.debug("stopping heartbeat monitor"),Object.keys(this.timeouts).forEach((e=>{this.context.windowProvider.clearTimeout(this.timeouts[e])})),this.timeouts={},this.isRunning=!1}subscribeToCoreSettings(){this.context.coreSettings.getObservable(l.J.Telemetry).subscribe((e=>{var t,i,n;const{enableHeartbeatMonitor:r,heartbeatConfiguration:a}=e;a?(this._configuration=a,this.logger.debug("Configuration loaded...",this._configuration)):null===(i=(t=this.logger).errorToTelemetry)||void 0===i||i.call(t,"'heartbeatConfiguration' not found.","fundamentals_performance_heartbeat_monitor"),r?(this.startHeartbeat(),(null===(n=this._configuration)||void 0===n?void 0:n.memoryMetricsCollection.enabled)||(this.context.windowProvider.clearTimeout(this.timeouts.memory),this.timeouts.memory=void 0)):this.stopHeartbeat()}))}startHeartbeat(){!this.isRunning&&this.logger.debug("starting heartbeat monitor"),this.scheduleNextTimeout("heartbeat",this.isRunning?this.getHeartbeatInterval():Math.min(30,this.getHeartbeatInterval()),this.beat.bind(this),this.getHeartbeatInterval),this.scheduleNextTimeout("memory",this.isRunning?this.getMemorySubInterval():Math.min(25,this.getMemorySubInterval()),this.collectGranularMemoryAndJSHeapData.bind(this),this.getMemorySubInterval),this.isRunning=!0}scheduleNextTimeout(e,t=Number.MAX_SAFE_INTEGER,i,r){var a;const o=t*c.B.second;0<o&&o<2147483647&&(this.timeouts[e]=null!==(a=this.timeouts[e])&&void 0!==a?a:this.context.windowProvider.setTimeout((()=>(0,n.__awaiter)(this,void 0,void 0,(function*(){var t,n;this.timeouts[e]=void 0;try{yield i()}catch(e){null===(n=(t=this.logger).errorToTelemetry)||void 0===n||n.call(t,`call to function '${i}' failed in heartbeat monitor.`,"fundamentals_performance_heartbeat_monitor")}finally{this.scheduleNextTimeout(e,r(),i,r)}}))),o))}beat(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.collectData();(0,u.aA)(e)}))}getElapsedTime(){const e=(new Date).getTime(),t=this.initializedTime||e;return{elapsed:Math.floor((e-t)/c.B.second)}}getAverageMemoryMetrics(){const e=[];if(this.granularNativeMetrics.length){const t=new Map(this.peakWorkingSetByProcess.entries());this.peakWorkingSetByProcess.clear(),this.granularNativeMetrics.reduce(((e,t)=>{var i;for(const n of t){const{processId:t}=n;e.set(t,(null!==(i=e.get(t))&&void 0!==i?i:[]).concat(n))}return e}),new Map).forEach(((i,n)=>{var r;this.peakWorkingSetByProcess.set(n,null!==(r=t.get(n))&&void 0!==r?r:0);const a=(0,f.meanBy)(i,(e=>e.workingSetSizeKB)),o=(0,f.meanBy)(i,(e=>e.commitSizeKB)),s={processId:n,name:i[0].name,type:i[0].type,utilitySubType:i[0].utilitySubType,embeddedBrowserWebView:i[0].embeddedBrowserWebView,cpuCycleTime:i[0].cpuCycleTime,workingSetSizeKB:isNaN(a)?void 0:Math.round(a),commitSizeKB:isNaN(o)?void 0:Math.round(o)};e.push(s)}))}const t=[];this.granularWorkerMetrics.length&&this.granularWorkerMetrics.reduce(((e,t)=>{var i;for(const n of t){const{targetSessionId:t}=n;e.set(t,(null!==(i=e.get(t))&&void 0!==i?i:[]).concat(n))}return e}),new Map).forEach(((e,i)=>{const n=(0,f.meanBy)(e,(e=>e.totalSizeKB)),r=(0,f.meanBy)(e,(e=>e.usedSizeKB)),a={targetSessionId:i,type:e[0].type,subType:e[0].subType,totalSizeKB:isNaN(n)?void 0:Math.round(n),usedSizeKB:isNaN(r)?void 0:Math.round(r)};t.push(a)}));const i=(0,m.Mv)(e,this.peakWorkingSetByProcess,this.mainRendererProcessId),n=(0,m.tC)(t);let r={};if(this.granularJSHeapMetrics.length){const e={jsHeapSizeLimit:Math.round((0,f.meanBy)(this.granularJSHeapMetrics,(e=>e.jsHeapSizeLimit||0))),totalJSHeapSize:Math.round((0,f.meanBy)(this.granularJSHeapMetrics,(e=>e.totalJSHeapSize||0))),usedJSHeapSize:Math.round((0,f.meanBy)(this.granularJSHeapMetrics,(e=>e.usedJSHeapSize||0)))};r=(0,m.RQ)(e,this.peakUsedJSHeapSize)}return Object.assign(Object.assign(Object.assign({},i),n),r)}getAriMetrics(){const e={Perf_Ari:""};if(this.context.appResponsivenessService){const t=this.context.appResponsivenessService.getTelemetry();e.Perf_Ari=t}return e}getDataClientMetrics(){const e={Perf_ApolloCacheStats:void 0};if(this.context.dataClientTrackingService){const t=this.context.dataClientTrackingService.getTelemetry();e.Perf_ApolloCacheStats=t}return e}getWindowMetrics(){const e={Perf_WindowStats:void 0};if(this.context.windowTrackerService){const t=this.context.windowTrackerService.getTelemetry();e.Perf_WindowStats=t}return e}getObjectLeakDetectorMetrics(){const e={};return this.context.leakDetectorService&&(e.Perf_OLDStats=this.context.leakDetectorService.getTelemetry()),e}getClientStateMetrics(){const e={Perf_IsUserInCall:void 0};if(this.context.clientState){const t=this.context.clientState.getState()===p.pk.VeryActive;e.Perf_IsUserInCall=t}return e}getCallingData(){const e={Perf_Calling_Data:void 0};return this.packedCallingData.forEach((t=>{e.Perf_Calling_Data?e.Perf_Calling_Data.push(...t):e.Perf_Calling_Data=t})),this.packedCallingData.clear(),e}getGraphQLStoreMetrics(){const e={};return this.context.graphqlStoreStatsReporterService&&(e.Perf_GraphQLStoreStats=this.context.graphqlStoreStatsReporterService.getTelemetry()),e}getPlatformAppsMetrics(){let e={};if(this.lastMemoryMetrics){const t=this.platformAppsManagementService.getTelemetry(this.lastMemoryMetrics);e={Perf_PlatformApps_Active_WorkingSet:t.activeWorkingSetSizeKB,Perf_PlatformApps_Cached_WorkingSet:t.cachedWorkingSetSizeKB,Perf_PlatformApps_Active_Commit_Size:t.activeCommitSizeKB,Perf_PlatformApps_Cached_Commit_Size:t.cachedCommitSizeKB,Perf_PlatformApps_Count_CachedApps:t.cachedAppsCount,Perf_PlatformApps_Count_ActiveApps:t.activeAppsCount,Perf_PlatformApps_Stats:t.appsPlatformStats}}return e}collectGranularMemoryAndJSHeapData(){var e,t,i;return(0,n.__awaiter)(this,void 0,void 0,(function*(){const n=Math.max(Math.floor(this.getHeartbeatInterval()/this.getMemorySubInterval()),1)||1;if(this.context.hostCommunicationService){const r=yield(0,h.K)(this.context.hostCommunicationService,(null===(t=null===(e=this._configuration)||void 0===e?void 0:e.workerMetricsCollection)||void 0===t?void 0:t.enabled)||!1);this.lastMemoryMetrics=r,this.granularNativeMetrics=this.granularNativeMetrics.concat([r.processes]).slice(-n),this.granularWorkerMetrics=this.granularWorkerMetrics.concat([r.workers]).slice(-n);const a=[];for(const e of r.processes){const{processId:t,type:i}=e,n=this.peakWorkingSetByProcess.get(t);this.peakWorkingSetByProcess.set(t,Math.max(n||0,e.workingSetSizeKB||0)),"renderer"===i.toLowerCase()&&a.push(e)}this.mainRendererProcessId=this.mainRendererProcessId&&a.find((e=>e.processId===this.mainRendererProcessId))?this.mainRendererProcessId:null===(i=a.sort(((e,t)=>{var i,n;return(null!==(i=t.workingSetSizeKB)&&void 0!==i?i:0)-(null!==(n=e.workingSetSizeKB)&&void 0!==n?n:0)}))[0])||void 0===i?void 0:i.processId}else this.logger.error("Invalid hostCommunicationService, cannot get metrics from Desktop");if(this.context.windowProvider){const e=(0,v.P)(this.context.windowProvider);this.peakUsedJSHeapSize=Math.max(this.peakUsedJSHeapSize,e.usedJSHeapSize||0),this.granularJSHeapMetrics=this.granularJSHeapMetrics.concat(e).slice(-n)}}))}registerScenarios(){return(0,n.__awaiter)(this,void 0,void 0,(function*(){if(this.context.hostCommunicationService){const e=yield this.context.hostCommunicationService.loadModule("heartbeat");if(null==e?void 0:e.registerForScenarioStart)try{e.registerForScenarioStart((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios starting")}if(null==e?void 0:e.registerForScenarioStop)try{e.registerForScenarioStop((e=>{}))}catch(e){this.logger.error("Failed to register for listening to host scenarios stopping")}}}))}}S.instance=void 0},16314:(e,t,i)=>{i.d(t,{E:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformAppButtonQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appButtonResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"action"}}]}}]}}]}},73831:(e,t,i)=>{i.d(t,{i:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformBackButtonHandlerStateQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"backButtonHandlerState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"registered"}}]}}]}}]}},766073:(e,t,i)=>{i.d(t,{L:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}}]}}]}}]}},235318:(e,t,i)=>{i.d(t,{N:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformChangeSettingsTriggerQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeSettingsTriggerResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},864158:(e,t,i)=>{i.d(t,{O:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataClientPlatformLocalFrameContextQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"localFrameContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"tabId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}}]}}]}}]}},598706:(e,t,i)=>{i.d(t,{i:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mapCoordinateResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mapCoordinateResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}},{kind:"Field",name:{kind:"Name",value:"locationApiError"}}]}}]}}]}},49920:(e,t,i)=>{i.d(t,{n:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToChildResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToChildResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},698609:(e,t,i)=>{i.d(t,{y:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},418544:(e,t,i)=>{i.d(t,{a:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectMediaResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectMediaError"}},{kind:"Field",name:{kind:"Name",value:"mediaUrls"}}]}}]}}]}},627109:(e,t,i)=>{i.d(t,{k:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"selectPeoplePickerResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"selectPeoplePickerResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}}]}}]}}]}},204334:(e,t,i)=>{i.d(t,{F:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"showLocationResponse"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"showLocationResponse"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},752906:(e,t,i)=>{i.d(t,{sR:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"taskModuleResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"taskModuleResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"card"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"adaptiveCardTabResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}}]}},{kind:"Field",name:{kind:"Name",value:"text"}},{kind:"Field",name:{kind:"Name",value:"taskModuleId"}},{kind:"Field",name:{kind:"Name",value:"draftId"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"reason"}},{kind:"Field",name:{kind:"Name",value:"entryPoint"}}]}}]}}]}},300553:(e,t,i)=>{i.d(t,{R:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"viewImagesResult"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesResult"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewImagesError"}},{kind:"Field",name:{kind:"Name",value:"errorCode"}}]}}]}}]}},244634:(e,t,i)=>{i.d(t,{hXz:()=>n.hXz,IGm:()=>n.IGm,QFN:()=>n.QFN,sjk:()=>n.sjk,Usq:()=>n.Usq,xz$:()=>n.xz$,cS$:()=>n.cS$,T8Q:()=>n.T8Q,xa1:()=>n.xa1,OQO:()=>n.OQO,kfo:()=>n.kfo,c3b:()=>n.c3b,BLW:()=>n.BLW,NK9:()=>n.NK9,Ei:()=>n.Ei,jx2:()=>n.jx2,Jbg:()=>n.Jbg,MTl:()=>n.MTl,JPG:()=>n.JPG,YEG:()=>n.YEG,Vuv:()=>n.Vuv,LYR:()=>n.LYR,XW6:()=>n.XW6,sQ6:()=>n.sQ6,PwB:()=>n.PwB,s8E:()=>n.s8E,_Ll:()=>n._Ll,VDl:()=>n.VDl,JEf:()=>n.JEf,qi6:()=>n.qi6,JMQ:()=>n.JMQ,OPt:()=>n.OPt,YVt:()=>n.YVt,OQr:()=>n.OQr,$hY:()=>n.$hY,dXV:()=>n.dXV,yhY:()=>n.yhY,Y5e:()=>n.Y5e,YHP:()=>n.YHP,FXX:()=>n.FXX,Vne:()=>n.Vne,m0e:()=>n.m0e,BzI:()=>n.BzI,zO$:()=>n.zO$,kUQ:()=>n.kUQ,sfQ:()=>n.sfQ,LmM:()=>n.LmM,wGx:()=>n.wGx,ZB_:()=>n.ZB_,H9H:()=>n.H9H,MSv:()=>n.MSv,Zwl:()=>n.Zwl,Ili:()=>n.Ili,_BL:()=>n._BL,nUz:()=>n.nUz,Chc:()=>n.Chc,G7Z:()=>n.G7Z,zGj:()=>n.zGj,w4O:()=>n.w4O,Yfn:()=>n.Yfn,Hl5:()=>n.Hl5,a8y:()=>n.a8y,o2x:()=>n.o2x,FHR:()=>n.FHR,nEL:()=>n.nEL,sRD:()=>n.sRD,XDy:()=>n.XDy,lFB:()=>n.lFB,XuV:()=>n.XuV,nK:()=>n.nK,R0O:()=>n.R0O,MnL:()=>n.MnL,$xD:()=>n.$xD,WVv:()=>n.WVv,xUu:()=>n.xUu,CF7:()=>n.CF7,vSz:()=>n.vSz,Ivr:()=>n.Ivr,OIX:()=>n.OIX,v6g:()=>n.v6g,VwM:()=>n.VwM,tf6:()=>n.tf6,A49:()=>n.A49,sTL:()=>n.sTL,TPs:()=>n.TPs,jld:()=>n.jld,G7F:()=>n.G7F,dOI:()=>n.dOI,Io4:()=>n.Io4,M4c:()=>n.M4c,eQ$:()=>n.eQ$,Ulw:()=>n.Ulw,Frf:()=>n.Frf,tL2:()=>n.tL2,xNx:()=>n.xNx,ufv:()=>n.ufv,oDm:()=>n.oDm,P3i:()=>n.P3i,YQ8:()=>n.YQ8,y3S:()=>n.y3S,MUv:()=>n.MUv,jQt:()=>n.jQt,vo$:()=>n.vo$,npU:()=>n.npU,Vos:()=>n.Vos,LWr:()=>n.LWr,VRN:()=>n.VRN,IU_:()=>n.IU_,I_G:()=>n.I_G,Ge7:()=>n.Ge7,T3A:()=>n.T3A,zYS:()=>n.zYS,kwT:()=>n.kwT,Ryo:()=>n.Ryo,Io1:()=>n.Io1,fCN:()=>n.fCN,ICr:()=>n.ICr,x1h:()=>n.x1h,URt:()=>n.URt,Qv1:()=>n.Qv1,BdF:()=>n.BdF,FTP:()=>n.FTP,hyV:()=>n.hyV,xys:()=>n.xys,XR$:()=>n.XR$,cw:()=>n.cw,Cdg:()=>n.Cdg,kG0:()=>n.kG0,BNj:()=>n.BNj,SIK:()=>n.SIK,RJA:()=>n.RJA,OJN:()=>n.OJN,QeU:()=>n.QeU,jpo:()=>n.jpo,YnP:()=>n.YnP,prp:()=>n.prp,Uq$:()=>n.Uq$,BHj:()=>n.BHj,eb2:()=>n.eb2,KRy:()=>n.KRy,GXC:()=>n.GXC,Iho:()=>n.Iho,cCY:()=>n.cCY,h6$:()=>n.h6$,wml:()=>n.wml,$0E:()=>n.$0E,mz$:()=>n.mz$,OQk:()=>n.OQk,n96:()=>n.n96,s8d:()=>n.s8d,XIP:()=>n.XIP,ytf:()=>n.ytf,Tak:()=>n.Tak,P7$:()=>n.P7$,xuW:()=>n.xuW,Fu9:()=>n.Fu9,Z4B:()=>n.Z4B,Rb4:()=>n.Rb4,k2e:()=>n.k2e,z_3:()=>n.z_3,sTm:()=>n.sTm,B1J:()=>n.B1J,kK_:()=>n.kK_,AeV:()=>n.AeV,wIZ:()=>n.wIZ,wls:()=>n.wls,JKW:()=>n.JKW,aR8:()=>n.aR8,xvC:()=>n.xvC,clf:()=>n.clf,kjp:()=>n.kjp,Ae9:()=>n.Ae9,Dyf:()=>n.Dyf,J37:()=>n.J37,H0s:()=>n.H0s,_Bi:()=>n._Bi,Q9H:()=>n.Q9H,l8x:()=>n.l8x,GQc:()=>n.GQc,zct:()=>n.zct,jDS:()=>n.jDS,dcg:()=>n.dcg,xP5:()=>n.xP5,gXl:()=>n.gXl,l5h:()=>n.l5h,yOG:()=>n.yOG,VTC:()=>n.VTC,ERR:()=>n.ERR,LUR:()=>n.LUR,MZr:()=>n.MZr,WR8:()=>n.WR8,zcD:()=>n.zcD,kge:()=>n.kge,dRH:()=>n.dRH,c$2:()=>n.c$2,YN3:()=>n.YN3,BFo:()=>n.BFo,BsF:()=>n.BsF,U4g:()=>n.U4g,rsL:()=>n.rsL,LQX:()=>n.LQX,ws1:()=>n.ws1,zO9:()=>n.zO9,XoC:()=>n.XoC,ODi:()=>n.ODi,AcR:()=>n.AcR,X9x:()=>n.X9x,Fd9:()=>n.Fd9,ffC:()=>n.ffC,TDJ:()=>n.TDJ,IEi:()=>n.IEi,yNt:()=>n.yNt,AMX:()=>n.AMX,Yii:()=>n.Yii,y2I:()=>n.y2I,LVq:()=>n.LVq,Liy:()=>n.Liy,jWr:()=>n.jWr,WBC:()=>n.WBC,Rdl:()=>n.Rdl,Jb0:()=>n.Jb0,H9T:()=>n.H9T,XdF:()=>n.XdF,v0k:()=>n.v0k,mGI:()=>n.mGI,pMG:()=>n.pMG,QuG:()=>n.QuG,mFq:()=>n.mFq,Slq:()=>n.Slq,Hdy:()=>n.Hdy,vdn:()=>n.vdn,SMg:()=>n.SMg,LQ7:()=>n.LQ7,PFp:()=>n.PFp,aUL:()=>n.aUL,C55:()=>n.C55,phe:()=>n.phe,ukP:()=>n.ukP,suD:()=>n.suD,pyR:()=>n.pyR,feW:()=>n.feW,Ln2:()=>n.Ln2,F6r:()=>n.F6r,f4k:()=>n.f4k,Qbq:()=>n.Qbq,P7M:()=>n.P7M,jlU:()=>n.jlU,uNA:()=>n.uNA,EK3:()=>n.EK3,LQM:()=>n.LQM,qeQ:()=>n.qeQ,bzN:()=>n.bzN,oqG:()=>n.oqG,qcc:()=>n.qcc,Xom:()=>n.Xom,lhu:()=>n.lhu,LHZ:()=>n.LHZ,Nbe:()=>n.Nbe,ydL:()=>n.ydL,_WJ:()=>n._WJ,RqE:()=>n.RqE,mFJ:()=>n.mFJ,vXL:()=>n.vXL,ven:()=>n.ven,NsI:()=>n.NsI,Af8:()=>n.Af8,TBq:()=>n.TBq,oNc:()=>n.oNc,nwx:()=>n.nwx,$qY:()=>n.$qY,cj1:()=>n.cj1,Djg:()=>n.Djg,XXy:()=>n.XXy,a4b:()=>n.a4b,BUw:()=>n.BUw,RWp:()=>n.RWp,$Q1:()=>n.$Q1,Da2:()=>n.Da2,WzC:()=>n.WzC,CRV:()=>n.CRV,uJ4:()=>n.uJ4,eN:()=>n.eN,wkl:()=>n.wkl,dxg:()=>n.dxg,S1B:()=>n.S1B,clb:()=>n.clb,Kb4:()=>n.Kb4,osM:()=>n.osM,m1e:()=>n.m1e,nzs:()=>n.nzs,y$p:()=>n.y$p,vJe:()=>n.vJe,wzb:()=>n.wzb,VpQ:()=>n.VpQ,Dhn:()=>n.Dhn,Up8:()=>n.Up8,MwA:()=>n.MwA,UMR:()=>n.UMR,kBB:()=>n.kBB,YeP:()=>n.YeP,rQh:()=>n.rQh,e30:()=>n.e30,uI5:()=>n.uI5,MwQ:()=>n.MwQ,WZ1:()=>n.WZ1,Xh1:()=>n.Xh1,r2Q:()=>n.r2Q,CB9:()=>n.CB9,kAY:()=>n.kAY,lOW:()=>n.lOW,msV:()=>n.msV,LwA:()=>n.LwA,ENt:()=>n.ENt,UnB:()=>n.UnB,CNO:()=>n.CNO,eNG:()=>n.eNG,UT7:()=>n.UT7,gzh:()=>n.gzh,bGy:()=>n.bGy,NtM:()=>n.NtM,_iy:()=>n._iy,rB1:()=>n.rB1,ZnX:()=>n.ZnX,wR5:()=>n.wR5,sTX:()=>n.sTX,xen:()=>n.xen,$pD:()=>n.$pD,IEy:()=>n.IEy,oR$:()=>n.oR$,mez:()=>n.mez,lcg:()=>n.lcg,KY$:()=>n.KY$,j5k:()=>n.j5k,YXx:()=>n.YXx,unu:()=>n.unu,Oig:()=>n.Oig,mTO:()=>n.mTO,LJK:()=>n.LJK,ZAT:()=>n.ZAT,Xjc:()=>n.Xjc,ceh:()=>n.ceh,yG1:()=>n.yG1,Cyn:()=>n.Cyn,UOl:()=>n.UOl,cku:()=>n.cku,aVM:()=>n.aVM,NNg:()=>n.NNg,X6H:()=>n.X6H,su9:()=>n.su9,Le1:()=>n.Le1,M_S:()=>n.M_S,T1N:()=>n.T1N,u1r:()=>n.u1r,Vf1:()=>n.Vf1,wVt:()=>n.wVt,gcs:()=>n.gcs,gCs:()=>n.gCs,XKC:()=>n.XKC,z$r:()=>n.z$r,MEc:()=>n.MEc,LB2:()=>n.LB2,ytK:()=>n.ytK,XRp:()=>n.XRp,Ajc:()=>n.Ajc,wJZ:()=>n.wJZ,c0v:()=>n.c0v,$cQ:()=>n.$cQ,HBY:()=>n.HBY,ht_:()=>n.ht_,wHp:()=>n.wHp,evG:()=>n.evG,EG2:()=>n.EG2,Ntc:()=>n.Ntc,rgk:()=>n.rgk,YYW:()=>n.YYW,Mem:()=>n.Mem,P$n:()=>n.P$n,TEU:()=>n.TEU,rJC:()=>n.rJC,W2:()=>n.W2,gNb:()=>n.gNb,qPe:()=>n.qPe,h$0:()=>n.h$0,fFE:()=>n.fFE,fEB:()=>n.fEB,IH6:()=>n.IH6,zk2:()=>n.zk2,tHj:()=>n.tHj,HrE:()=>n.HrE,k$E:()=>n.k$E,UQW:()=>n.UQW,$IJ:()=>n.$IJ,U6l:()=>n.U6l,Sej:()=>n.Sej,z$1:()=>n.z$1,bkD:()=>n.bkD,zMv:()=>n.zMv,swL:()=>n.swL,AyW:()=>n.AyW,xK:()=>n.xK,nmV:()=>n.nmV,oDq:()=>n.oDq,rr4:()=>n.rr4,Ie1:()=>n.Ie1,ebH:()=>n.ebH,ehc:()=>n.ehc,L8l:()=>n.L8l,sfo:()=>n.sfo,xHp:()=>n.xHp,vE1:()=>n.vE1,Of:()=>n.Of,TEL:()=>n.TEL,b8x:()=>n.b8x,nkg:()=>n.nkg,YIJ:()=>n.YIJ,z7v:()=>n.z7v,Rk4:()=>n.Rk4,Q$q:()=>n.Q$q,bh4:()=>n.bh4,GYn:()=>n.GYn,HOj:()=>n.HOj,O3C:()=>n.O3C,opK:()=>n.opK,YYO:()=>n.YYO,bCV:()=>n.bCV,Mck:()=>n.Mck,b1t:()=>n.b1t,TSI:()=>n.TSI,eft:()=>n.eft,UWY:()=>n.UWY,M9W:()=>n.M9W,fk5:()=>n.fk5,z_G:()=>n.z_G,mZW:()=>n.mZW,Ygv:()=>n.Ygv,Voh:()=>n.Voh,OLn:()=>n.OLn,ASP:()=>n.ASP,$Kr:()=>n.$Kr,p1$:()=>n.p1$,OPX:()=>n.OPX,Qhk:()=>n.Qhk,sqJ:()=>n.sqJ,rtK:()=>n.rtK,btQ:()=>n.btQ,x4d:()=>n.x4d,hQF:()=>n.hQF,h88:()=>n.h88,h5P:()=>n.h5P,HnM:()=>n.HnM,A1$:()=>n.A1$,W8Z:()=>n.W8Z,pqZ:()=>n.pqZ,DTV:()=>n.DTV,mH$:()=>n.mH$,c$B:()=>n.c$B,DGS:()=>n.DGS,yVM:()=>n.yVM,lom:()=>n.lom,Em8:()=>n.Em8,D73:()=>n.D73,Hy_:()=>n.Hy_,_Gd:()=>n._Gd,LE8:()=>n.LE8,D8e:()=>n.D8e,HTB:()=>n.HTB,Loq:()=>n.Loq,amW:()=>n.amW,Xzf:()=>n.Xzf,RaO:()=>n.RaO,CO3:()=>n.CO3,s1w:()=>n.s1w,rRG:()=>n.rRG,KZH:()=>n.KZH,oXn:()=>n.oXn,TPi:()=>n.TPi,DjH:()=>n.DjH,p8s:()=>n.p8s,BIC:()=>n.BIC,vDg:()=>n.vDg,EhV:()=>n.EhV,ts3:()=>n.ts3,_eA:()=>n._eA,XlO:()=>n.XlO,jer:()=>n.jer,CDU:()=>n.CDU,dQF:()=>n.dQF,rZ3:()=>n.rZ3,fZW:()=>n.fZW,NPL:()=>n.NPL,Bpo:()=>n.Bpo,orD:()=>n.orD,$nY:()=>n.$nY,wJo:()=>n.wJo,xyM:()=>n.xyM,xwW:()=>n.xwW,Bo:()=>n.Bo,FFn:()=>n.FFn,Jpo:()=>n.Jpo,U5q:()=>n.U5q,VSu:()=>n.VSu,XQ2:()=>n.XQ2,NHA:()=>n.NHA,ja_:()=>n.ja_,f15:()=>n.f15,AjG:()=>n.AjG,q2e:()=>n.q2e,iTP:()=>n.iTP,c_Z:()=>n.c_Z,HRx:()=>n.HRx,XDD:()=>n.XDD,EUN:()=>n.EUN,myd:()=>n.myd,WLT:()=>n.WLT,sCu:()=>n.sCu,f1K:()=>n.f1K,Hn1:()=>n.Hn1,SrV:()=>n.SrV,PaK:()=>n.PaK,ZSI:()=>n.ZSI,ig0:()=>n.ig0,ynw:()=>n.ynw,BUQ:()=>n.BUQ,ozu:()=>n.ozu,fNK:()=>n.fNK,v2d:()=>n.v2d,OE2:()=>n.OE2,r7c:()=>n.r7c,OO0:()=>n.OO0,fSs:()=>n.fSs,qVz:()=>n.qVz,FT_:()=>n.FT_,k3Z:()=>n.k3Z,w$N:()=>n.w$N,jxR:()=>n.jxR,Vfj:()=>n.Vfj,fNg:()=>n.fNg,Z7A:()=>n.Z7A,JJh:()=>n.JJh,g9K:()=>n.g9K,tF7:()=>n.tF7,oR4:()=>n.oR4,VLC:()=>n.VLC,zPu:()=>n.zPu,pq3:()=>n.pq3,BYq:()=>n.BYq,l2X:()=>n.l2X,vb$:()=>n.vb$,Kks:()=>n.Kks,gVh:()=>n.gVh,pyY:()=>n.pyY,eUH:()=>n.eUH,wZ4:()=>n.wZ4,yvs:()=>n.yvs,ZHF:()=>n.ZHF,$lW:()=>n.$lW,iNV:()=>n.iNV,k_p:()=>n.k_p,reX:()=>n.reX,C9I:()=>n.C9I,phR:()=>n.phR,_34:()=>n._34,$u5:()=>n.$u5,V9I:()=>n.V9I,Bg:()=>n.Bg,nqg:()=>n.nqg,s1:()=>n.s1,nx0:()=>n.nx0,eDm:()=>n.eDm,aU:()=>n.aU,Q2A:()=>n.Q2A,Z8d:()=>n.Z8d,WOu:()=>n.WOu,GSK:()=>n.GSK,pCN:()=>n.pCN,Vif:()=>n.Vif,ivb:()=>n.ivb,Dz_:()=>n.Dz_,Z9q:()=>n.Z9q,Cn5:()=>n.Cn5,Qen:()=>n.Qen,ygE:()=>n.ygE,taM:()=>n.taM,Lps:()=>n.Lps,zwH:()=>n.zwH,kUj:()=>n.kUj,Yvc:()=>n.Yvc,C14:()=>n.C14,fXy:()=>n.fXy,arA:()=>n.arA,HRk:()=>n.HRk,fGh:()=>n.fGh,_fr:()=>n._fr,idH:()=>n.idH,JEq:()=>n.JEq,oNF:()=>n.oNF,UZQ:()=>n.UZQ,kz6:()=>n.kz6,$xx:()=>n.$xx,LXf:()=>n.LXf,dOr:()=>n.dOr,nV$:()=>n.nV$,i44:()=>n.i44,$i$:()=>n.$i$,DPJ:()=>n.DPJ,SqH:()=>n.SqH,Cfe:()=>n.Cfe,VCP:()=>n.VCP,hvQ:()=>n.hvQ,hFs:()=>n.hFs,MpO:()=>n.MpO,nWM:()=>n.nWM,iR3:()=>n.iR3,cSI:()=>n.cSI,ipA:()=>n.ipA,WwQ:()=>n.WwQ,OCt:()=>n.OCt,o0l:()=>n.o0l,bax:()=>n.bax,wOR:()=>n.wOR,Ws2:()=>n.Ws2,g8S:()=>n.g8S,Mu6:()=>n.Mu6,UjV:()=>n.UjV,c87:()=>n.c87,ZR_:()=>n.ZR_,Tg8:()=>n.Tg8,i0v:()=>n.i0v,Bq8:()=>n.Bq8,yBp:()=>n.yBp,fjC:()=>n.fjC,RyT:()=>n.RyT,kg$:()=>n.kg$,MDw:()=>n.MDw,wi7:()=>n.wi7,Tuo:()=>n.Tuo,Vqf:()=>n.Vqf,l9N:()=>n.l9N,cAL:()=>n.cAL,JLw:()=>n.JLw,lCV:()=>n.lCV,sZ5:()=>n.sZ5,vhA:()=>n.vhA});var n=i(65903)},778764:(e,t,i)=>{if(i.d(t,{w:()=>l,K:()=>c,su:()=>p}),740179==i.j)var n=i(912825);var r=i(595068),a=i(47135),o=i(948519);const s=e=>e&&e.startsWith(r.V.Bot),d=e=>s(e)?e.slice(3):e.slice(e.includes("_")?41:8),l=(e,t)=>{let i=[];return i=s(e)&&!s(t)?[d(t),d(e)]:!s(e)&&s(t)?[d(e),d(t)]:[d(e),d(t)].sort(),`19:${i[0]}_${i[1]}@unq.gbl.spaces`};function c(){const[e,t]=(0,n.M)(2);return`${e}${t}`.substr(0,19)}function p(e){const{ageGroup:t}=e.get(a.J.AgeConsent);return t===o.zH.MinorWithMsaParentalConsent||t===o.zH.MinorWithoutMsaParentalConsent}},443467:(e,t,i)=>{i.d(t,{ne:()=>d,cx:()=>l,zP:()=>f});var n=i(381583),r=i(556569),a=i(533207),o=i(97600),s=i(197981);const d=(e,t,i,n)=>{const a=r.eo.getRequestCount(e),{accountEnabled:o,mri:s,objectId:d,displayName:l,givenName:h,surname:f,type:S,jobTitle:k,userPrincipalName:y,email:b,tenantId:C,sipProxyAddress:P,mobile:T,telephoneNumber:I,tenantName:_,decoratedDisplayName:N,cid:w,description:M,externalCalendarEmailAddress:x,homeMri:A,homeTenantId:L,profileType:D}=e,E={__typename:"User",accountEnabled:o,id:g(e),objectId:d,mri:s,displayName:l,givenName:h,surname:f,type:S,jobTitle:k,userPrincipalName:y,email:b,tenantId:i||C||null,sipProxyAddress:P,mobile:T,telephoneNumber:I,requestCount:a,preferredUserName:t,tenantName:_||null,decoratedDisplayName:N||null,cid:w,description:M,externalCalendarEmailAddress:x,emailForQuery:n,homeMri:A,homeTenantId:L,profileType:D};return function(e,t){const i=e.department;i&&(t.department=i)}(e,E),m(e,E),u(e,E),c(e,E),p(e,E),v(E),E},l=e=>{const{id:t,displayName:i,description:n,email:r,phone:a,mri:o,requestCount:s,syncSource:d}=e;return{__typename:"User",id:t,mri:o,objectId:o,displayName:i,userPrincipalName:o,givenName:i,surname:i,description:n,email:r,mobile:a,telephoneNumber:a,requestCount:s,syncSource:d}},c=(e,t)=>{var i;if(function(e){var t;const i=e;return void 0!==i.isFederated||void 0!==i.isAnonymousB2bUser||"federated"===(null===(t=i.type)||void 0===t?void 0:t.toLowerCase())}(e)){const{isFederated:n,fetchErrorCode:r,isAnonymousB2bUser:a}=e;t.isFederated=n||"federated"===(null===(i=e.type)||void 0===i?void 0:i.toLowerCase()),t.fetchErrorCode=r,t.isAnonymousB2bUser=a}else t.isFederated=null,t.fetchErrorCode=null,t.isAnonymousB2bUser=null},p=(e,t)=>{e.featureSettings&&(t.featureSettings=e.featureSettings),e.isBlocked&&(t.isBlocked=e.isBlocked),e.cid&&(t.cid=e.cid),e.isIbBarred&&(t.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(t.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(t.phonesInfo=(0,s.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(t.emailsInfo=(0,s.cloneDeep)(e.emailsInfo)),e.xtapUser&&(t.xtapUser=e.xtapUser),e.companyName&&(t.companyName=e.companyName),e.tenantName&&(t.tenantName=e.tenantName),e.imageUri&&(t.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(t.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarEtag&&(t.avatarEtag=e.avatarEtag),e.avatarUrl&&(t.avatarUrl=e.avatarUrl),t.isShortProfile=e.isShortProfile},u=(e,t)=>{(function(e){return void 0!==e.userType}(e)||function(e){const t=e;return t.type?t.type===n.t.botType:(0,o.bl)(e.mri)}(e)||function(e){var t,i;return"aduser"===(null===(t=e.type)||void 0===t?void 0:t.toLowerCase())||"aduser"===(null===(i=e.$$subType)||void 0===i?void 0:i.toLowerCase())}(e))&&(t.userType=e.userType,t.description=e.description,t.isUnified=e.isUnified,t.securityEnabled=e.securityEnabled,t.featureSettings=e.featureSettings,t.imageUri=e.imageUri,t.userLocation=e.userLocation)},m=(e,t)=>{const i=e.phones;i&&(t.phones=i.map((e=>h(e))))},h=e=>({number:e.number,type:e.type}),v=e=>{const{mri:t}=e;if((0,a.EG)(t)&&!e.displayName){const i=(0,a.Ol)(t);e.displayName=i,e.givenName=i}else if(t&&(0,o.MR)(t)&&!e.displayName){const i=(0,o.vq)(t);e.displayName=i,e.givenName=i}else e.displayName||(e.displayName="Unknown User");return e},f=e=>!!e&&!("string"!=typeof e||!r.eo.isTFLSmsVerifiedMri(e)),g=e=>e.mri||e.objectId||e.concatenatedId},595208:(e,t,i)=>{var n,r,a,o,s,d,l,c,p,u,m,h,v,f,g,S,k,y,b,C,P,T,I,_,N,w;i.d(t,{qi:()=>n,qb:()=>r,OM:()=>a,Pw:()=>o,aZ:()=>s,Aj:()=>d,jD:()=>l,BU:()=>c,YV:()=>p,Ye:()=>u,Uh:()=>m,i8:()=>h,Z9:()=>v,o1:()=>T,g7:()=>I,Hd:()=>_,_W:()=>N,n$:()=>w}),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat"}(n||(n={})),function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(r||(r={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(a||(a={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector"}(o||(o={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced"}(s||(s={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage"}(d||(d={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(l||(l={})),function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.TeamLevelApp="TeamLevelApp"}(c||(c={})),function(e){e.Application="Application",e.Delegated="Delegated"}(p||(p={})),function(e){e.MRU="MRU",e.AlphabeticalAsc="AlphabeticalAsc",e.AlphabeticalDesc="AlphabeticalDesc"}(u||(u={})),function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(m||(m={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(h||(h={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(v||(v={})),function(e){e.Mail="mail"}(f||(f={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(g||(g={})),function(e){e.General="general"}(S||(S={})),function(e){e.Short="short",e.Long="long"}(k||(k={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee"}(y||(y={})),function(e){e.After="after",e.Before="before"}(b||(b={})),function(e){e.Button="button",e.Menu="menu"}(C||(C={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(P||(P={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(T||(T={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(I||(I={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition"}(_||(_={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(N||(N={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(w||(w={}))},209114:(e,t,i)=>{i.d(t,{dP:()=>n,qN:()=>r,iv:()=>a,vO:()=>s,VS:()=>c,f1:()=>p,b:()=>u});var n,r,a,o,s,d,l=i(469929);!function(e){e.ScheduledDraft="ScheduledDraft"}(n||(n={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync",e[e.SyncOnDemandFromLongpoll=8]="SyncOnDemandFromLongpoll",e[e.AdHocPropertyUpdate=9]="AdHocPropertyUpdate"}(r||(r={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted"}(a||(a={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned"}(o||(o={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate",e[e.PutConversationLie=7]="PutConversationLie",e[e.AddUsersToConversation=8]="AddUsersToConversation",e[e.ConversationFetchJob=9]="ConversationFetchJob",e[e.GroupChatsStartupJob=10]="GroupChatsStartupJob",e[e.OneToOneChatFetchJob=11]="OneToOneChatFetchJob",e[e.NonRecentChatsStartupJob=12]="NonRecentChatsStartupJob",e[e.NonRecentChatsStartupRetryJob=13]="NonRecentChatsStartupRetryJob"}(s||(s={}));class c{}c.NotificationConversationId=`${l.at.PrivateFeed}notifications`,c.StarredConversationId=`${l.at.PrivateFeed}starred`,c.CallLogConversationId=`${l.at.PrivateFeed}calllogs`,c.AnnotationsConversationId=`${l.at.PrivateFeed}annotations`,function(e){e[e.Message=0]="Message"}(d||(d={}));const p="x-ms-request-priority";var u;!function(e){e[e.RealTimeSync=0]="RealTimeSync",e[e.ForegroundSync=10]="ForegroundSync",e[e.BackgroundSync=20]="BackgroundSync"}(u||(u={}))},844943:(e,t,i)=>{i.d(t,{wT:()=>m,Ut:()=>h,GS:()=>v,c_:()=>f,B8:()=>k,_2:()=>y,LQ:()=>b,Jn:()=>C,Iy:()=>P,R8:()=>T,vJ:()=>I,re:()=>_,mO:()=>N,dk:()=>w,io:()=>M,Bu:()=>x,x:()=>A,X5:()=>L,$n:()=>D,_T:()=>E,MQ:()=>U,Xc:()=>O,DA:()=>F,gw:()=>R,lj:()=>B,oy:()=>z,lF:()=>W});var n=i(47135),r=i(469929),a=i(737170),o=i(197981),s=i(209114),d=i(97600),l=i(65903),c=i(402527),p=i(310070),u=i(60746);const m=({isActionToAccept:e,isUserBlocked:t,isInQuarantine:i,quarantineCounter:a,creator:o,currentUserMri:s},d)=>{let l=r.uI.Accepted;if(e){if(t){const e=o===s,{maxInviteFreeQuarantineCounter:t}=d.get(n.J.People),c=a>=(t||0);i&&!e?l=r.uI.AcceptPending:e&&c&&(l=r.uI.Quarantined)}}else l=r.uI.Blocked;return l},h=e=>!!(null==e?void 0:e.startsWith(r.at.PhonelinkSmsPrefix)),v=(e,t)=>f(e.id,t)&&y(e,t),f=(e,t)=>{if(!S(e))return!1;const{overrideThreadTypeForPrivateFeeds:i}=t.get(n.J.Sync);return(!(0,d.dV)(e)||!i)&&!h(e)},g=/^\d+[:]{1}.+/,S=e=>!(0,o.isUndefined)(e)&&e!==r.kK&&e!==r.Ov&&!h(e)&&!e.includes(r.YP)&&!e.includes(r.BQ)&&g.test(e),k=e=>e.startsWith(r.IK)?"MRI conv id":e,y=(e,t)=>!(b(e)&&!function(e){const{msgEnableSfbCloudFromBVD:t}=e.get(n.J.Messaging),{isSfbCloud:i,isSipEnabled:r,isSfbCloudInBVD:a,isSipEnabledInBVD:o}=e.get(n.J.UserResources);return!!(t?o&&a:r&&i)}(t));function b(e){return((0,o.isString)(e)?e:e.id).endsWith(r.GQ)}const C=e=>!!e&&b(e),P=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[r.e0.RelationshipState];return!!(null==i?void 0:i.edRedemptionRequired)},T=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[r.e0.RelationshipState];return!!(null==i?void 0:i.blockTime)};const I=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[r.e0.IsModerator])},_=e=>e.threadProperties&&!!e.threadProperties[r.Q5.ParentSpaces],N=e=>e.threadProperties&&e.threadProperties[r.Q5.ThreadType]===a.T.Team&&_(e),w=e=>{var t,i;if(e.threadProperties&&(null===(t=e.threadProperties)||void 0===t?void 0:t[r.Q5.ParentSpaces]))try{const t=JSON.parse(null===(i=e.threadProperties)||void 0===i?void 0:i[r.Q5.ParentSpaces]);return t&&t.linkedSpaceInfoItems&&t.linkedSpaceInfoItems[0]&&t.linkedSpaceInfoItems[0].spaceThreadId&&t.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},M=e=>{if(e.threadProperties)try{const t=e.threadProperties.meeting,i=t?JSON.parse(t):void 0;return i?i.meetingType:void 0}catch(e){return}},x=e=>{if(e)try{const t=e.meeting,i=t?JSON.parse(t):void 0,n=i?i.isCommentStream:void 0;return!0===n||"true"===(null==n?void 0:n.toLowerCase())}catch(e){return}},A=e=>L(e.type),L=e=>!!e&&e.toLowerCase&&e.toLowerCase()===r.i1.Meeting.toLowerCase(),D=e=>{let t;if(A(e)&&e.threadProperties.meeting)try{const i=JSON.parse(e.threadProperties.meeting);i.subject&&(t=i.subject)}catch(e){return t}return t},E=e=>e===r.Cs.Text||e===r.Cs.RichText||e===r.Cs.HTML,U=e=>{var t;return!!(null===(t=e.members)||void 0===t?void 0:t.some((e=>(0,d.Nl)(e.id))))},O=e=>{var t;return e.id===s.VS.CallLogConversationId||(0,d.u5)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},F=e=>{const t=p.I*c.kg*p.s;if(!e||isNaN(e))return!0;return e-Date.now()<t},R=e=>(null==e?void 0:e.threadProperties)&&((null==e?void 0:e.threadProperties[r.Q5.ThreadType])===a.T.Community||(null==e?void 0:e.threadProperties[r.Q5.SpaceType])===r.Q5.SpaceType_Community),B=e=>e.threadProperties&&e.threadProperties[r.Q5.SubstrateGroupId]||"",z=e=>{var t,i;const n=null===(i=null===(t=e.threadProperties)||void 0===t?void 0:t[r.Q5.ThreadSubType])||void 0===i?void 0:i.toLowerCase();return n||u.YF.Unknown},W=e=>{const t=e.threadProperties&&e.threadProperties[r.Q5.ThreadType];return Q(t)},Q=e=>{if(e)return"space"===e||"topic"===e?l.k2e.Channel:"meeting"===e?l.k2e.Meeting:l.k2e.None}},490503:(e,t,i)=>{i.d(t,{MJ:()=>u,K6:()=>m,Du:()=>h,ut:()=>v,uY:()=>f,pl:()=>g,ky:()=>S,Fz:()=>k,zb:()=>y,s6:()=>b,rt:()=>C,xb:()=>P,eb:()=>T,HU:()=>I,X3:()=>_,Dq:()=>w,iX:()=>M,S5:()=>x,nV:()=>A,$V:()=>L,JJ:()=>D,J6:()=>E,sL:()=>U,pi:()=>O,Cd:()=>F,hk:()=>R,rj:()=>B,Fv:()=>z,hu:()=>W,dO:()=>Q,BL:()=>H,jo:()=>j,nZ:()=>$,iE:()=>V,hP:()=>J,qo:()=>q,CB:()=>G,au:()=>K,ZY:()=>X,T7:()=>Y,Xg:()=>Z,YP:()=>ee,Zg:()=>te,j8:()=>ne,W7:()=>re,is:()=>ae,dG:()=>le,Lg:()=>ce,Su:()=>pe,rP:()=>ue,As:()=>me,nL:()=>he,Bl:()=>ve,mB:()=>fe,Eu:()=>ge,hC:()=>Se,DZ:()=>ke,me:()=>ye,BU:()=>be,Ii:()=>Ce,$c:()=>Pe,tl:()=>Te,Ts:()=>Ie,wU:()=>_e,jM:()=>Me,Il:()=>xe,Fx:()=>Ae,Ki:()=>Le,rf:()=>De,cu:()=>Ee,ln:()=>Ue,iK:()=>Oe,y5:()=>Fe,Ti:()=>Re});var n=i(209114),r=i(197981),a=i(47135),o=i(97600),s=i(469929),d=i(737170),l=i(60746),c=i(844943),p=i(991161);var u;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(u||(u={}));const m=e=>{const t=T(e);return(0,c.LQ)(e)?t:t||(0,c.Jn)(e)},h=e=>{var t;return(null===(t=e.threadProperties)||void 0===t?void 0:t[s.Q5.Creator])||null},v=e=>e.threadProperties&&e.threadProperties[s.Q5.CreatedAt]?e.threadProperties[s.Q5.CreatedAt]:null,f=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const t=e.threadProperties.isDeleted||e.threadProperties[s.Q5.IsDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},g=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const t=e.properties.isDeleted||e.properties[s.Ff.isDeleted];return!!t&&("boolean"==typeof t?t:"function"==typeof t.toLowerCase&&"true"===t.toLowerCase())},S=(e,t)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const i=Q(e,t);return 0!==i&&(!(0,r.isNil)(e.lastMessageTimeUtc)&&i>=e.lastMessageTimeUtc)},k=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Followed])&&"true"===(null===(t=e.properties[s.Ff.Followed])||void 0===t?void 0:t.toLowerCase())},y=e=>{var t;return!(!e.properties||!e.properties[s.Ff.Collapsed])&&"true"===(null===(t=e.properties[s.Ff.Collapsed])||void 0===t?void 0:t.toLowerCase())},b=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,C=e=>b(e)||!J(e);function P(e){return e.includes(s.YP)||e.includes(s.BQ)||e===s.kK}const T=e=>{var t;return(0,o.Q5)(e.id,null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)&&P(e.id)},I=e=>e.threadProperties&&(e.threadProperties[s.Q5.ThreadType]===d.T.Team||e.threadProperties[s.Q5.ThreadType]===d.T.Community)&&!(0,c.re)(e),_=e=>O(e)?ye(e)||"":Y(e)||"";function N(e){return!!e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.Team}const w=e=>{var t;if(e.properties){if(e.properties[s.Ff.Favorite])return"true"===(null===(t=e.properties[s.Ff.Favorite])||void 0===t?void 0:t.toLowerCase());if(N(e))return!0}return!1},M=(e,t=!1)=>x(e.type,t),x=(e,t=!1)=>!(0,r.isNil)(e)&&(e.toLowerCase()===s.i1.Chat.toLowerCase()||e.toLowerCase()===s.i1.PhoneChat.toLowerCase()||e.toLowerCase()===s.i1.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===s.i1.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===s.i1.OneOnOne.toLowerCase()||e.toLowerCase()===s.i1.StreamOfNotes.toLowerCase()||!t&&(0,c.X5)(e)),A=e=>e.type===s.i1.RCC,L=e=>{var t;return e.id===n.VS.NotificationConversationId||(0,o.j6)(null===(t=null==e?void 0:e.threadProperties)||void 0===t?void 0:t.threadType)},D=e=>e===n.VS.AnnotationsConversationId,E=e=>e.type===s.i1.Team||e.type===s.i1.Topic,U=e=>q(e)===l.xu.Shared,O=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&q(e)===l.xu.Private,F=e=>I(e)&&!!e.memberProperties&&!!e.memberProperties[s.e0.ChannelOnlyMember],R=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Adhoc},B=e=>{if(!(0,c.x)(e))return!1;const t=(0,c.io)(e);return!!t&&t===s.wJ.Scheduled},z=(e,t)=>e.from.substring(e.from.indexOf("/")+1)===(-1===t.indexOf(s.rK)?s.rK+t:t),W=(e,t)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=t.get(a.J.Sync),n=i||U(e)?e.threadProperties.retentionHorizonV2:0;return n&&isFinite(Number(n))?Number(n):0},Q=(e,t)=>{if(!e.properties)return 0;if(g(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const i=(!t||!!t.get(a.J.Messaging).enableDeleteChat)&&M(e)?e.properties.clearHistoryTime:0;return i&&isFinite(Number(i))?Number(i):0},H=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,j=(e,t,i)=>{const n=W(t,i);return!isNaN(Number(e))&&!isNaN(n)&&Number(e)<n},$=(e,t,i)=>{const n=Q(t,i),r=Number(e);return!isNaN(r)&&!isNaN(n)&&r<n},V=(e,t,i=!1)=>{var n;if((0,o.Q5)(e.id,null===(n=null==e?void 0:e.threadProperties)||void 0===n?void 0:n.threadType)&&!b(e)){if(e.memberProperties&&i)return e.memberProperties[s.e0.ExpirationTime];if(e.members&&t){const i=(0,r.find)(e.members,(e=>e&&e.id===t));return i&&i.memberExpirationTime}return e.memberProperties&&e.memberProperties[s.e0.ExpirationTime]}},J=(e,t)=>{var i;return!(0,o.Q5)(e.id,null===(i=null==e?void 0:e.threadProperties)||void 0===i?void 0:i.threadType)||!b(e)&&!f(e)&&((0,r.isArray)(e.members)&&t?(0,r.some)(e.members,(e=>e&&e.id===t)):!(e.threadProperties&&E(e)&&!e.threadProperties[s.Q5.LastLeaveAt]&&!e.threadProperties[s.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[s.Q5.LastLeaveAt]&&(!e.threadProperties[s.Q5.LastJoinAt]||e.threadProperties[s.Q5.LastJoinAt]<e.threadProperties[s.Q5.LastLeaveAt])))};function q(e){if(!e||!E(e))return;const t=e.threadProperties[s.Q5.SpaceTypes],i=t?parseInt(t,10):0,n=!!e.threadProperties[s.Q5.SubstrateGroupId],r=(0,c.oy)(e);return n?r===l.YF.PrivateChannel?l.xu.Private:l.xu.Shared:(i&l.tG.Private)===l.tG.Private?l.xu.Private:l.xu.Standard}const G=(e,t)=>{var i;if(!!e.threadProperties.isLastMessageFromMe)return!0;const n=null===(i=e.lastMessage)||void 0===i?void 0:i.from;if(!n)return!1;return t===(0,r.last)(n.split("/"))},K=(e,t)=>(0,r.reduce)(e.members,((e,i)=>{const n=i.id;return n&&n!==t&&e.push(n),e}),[]),X=(e,t,i)=>{let n;const a=!e.members||!!e.members&&(0,r.some)(e.members,(e=>!e));if(i&&!a){const r=K(e,t);n=T(e)&&1===r.length?i[r[0]]:i[e.id]}return n},Y=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(M(e)){let t=e.threadProperties.topic;if(t&&-1!==t.indexOf(":")&&(t=void 0),!t&&(0,c.x)(e)){const i=(0,c.$n)(e);i&&(t=i)}return t}if(N(e)&&le(e)){const t=ye(e);if(t&&t.trim())return t}else{const t=e.threadProperties.topic,i=e.threadProperties[s.Q5.TopicThreadTopic];if(t&&t.trim())return t;if(i&&i.trim())return i}}return""},Z=(e,t=!1)=>M(e,!0)&&!ee(e,t),ee=(e,t=!1)=>{var i;const n=e.members&&e.members.length<=2;return M(e,!0)&&n&&(ae(e)||T(e)||de(e)||!t&&se(e)||ie(e))&&!(null===(i=e.members)||void 0===i?void 0:i.some((e=>(0,o.$i)(e.id))))},te=e=>{var t;return ee(e)&&(null===(t=e.members)||void 0===t?void 0:t.some((({id:e})=>(0,o.bl)(e))))},ie=e=>e.members&&e.members.length<=2&&oe(e)&&(e.type===s.i1.PhoneChat||e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.PhoneChat),ne=e=>(0,c.Ut)(e),re=e=>e.type===s.i1.PhonelinkGroupChat,ae=e=>e.type===s.i1.Phonelink1on1Chat,oe=e=>(0,r.some)(e.members,(e=>!!e.id&&e.id.startsWith(s.at.Pstn))),se=e=>M(e,!0)&&e.members&&2===e.members.length&&!(0,r.isNil)(e.threadProperties)&&parseInt(e.threadProperties[s.Q5.CreatedAt],10)<s.Yv,de=e=>{var t,i;return!!e.id&&e.id.indexOf(s.B3)>-1||"true"===(null===(i=null===(t=e.threadProperties[s.Q5.P2PChatUniqueRosterThread])||void 0===t?void 0:t.toString())||void 0===i?void 0:i.toLowerCase())||Ne(e)},le=e=>e.threadProperties&&e.threadProperties[s.Q5.ThreadType]===d.T.Topic||O(e)||U(e),ce=e=>(0,c.Jn)(e),pe=e=>ve(e&&e.id),ue=e=>ce(e)||(e=>me(e))(e)||pe(e),me=e=>{const t=(0,r.isString)(e)?e:e.id;return(0,r.endsWith)(t,s.M9)||(0,r.endsWith)(t,s.IS)||(0,r.startsWith)(t,s.X2)},he=e=>me(e)||_e(e),ve=e=>!!e&&((0,r.endsWith)(e,s.RS)||(0,r.startsWith)(e,s.QV)),fe=e=>e===s.Z,ge=e=>{const t=(0,r.endsWith)(e,s.M9)||(0,r.endsWith)(e,s.IS)||(0,r.startsWith)(e,s.X2),i=e.endsWith(s.GQ),n=ve(e);return t||i||n},Se=e=>{const t=V(e),i=t&&t<Date.now();return J(e)&&!i},ke=e=>{if(e.threadProperties&&e.threadProperties[s.Q5.Topics]){const t=e.threadProperties[s.Q5.Topics];if("["!==t.substr(0,1))return t.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(t)}catch(e){return[]}}return[]},ye=e=>{if(e.threadProperties){if(e.threadProperties[s.Q5.XTeamName])return e.threadProperties[s.Q5.XTeamName];if(e.type===s.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},be=e=>{const t=ke(e),i=ye(e);return t.map((t=>{const n={},r=t.name;return n[s.Q5.CreatedAt]=parseInt(t.createdat,10),n[s.Q5.Picture]=t.picture,n[s.Q5.IsDeleted]=t.isdeleted,n[s.Q5.XTeamName]=t.isShared?r:i,n.topic=r,n[s.Q5.TopicThreadTopic]=r,{threadProperties:n,id:t.id,members:[],messages:"",properties:{},version:0,type:s.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},Ce=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const t=JSON.parse(e.threadProperties[s.Q5.ParentSpaces]),i=t.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,r.isEmpty)(i))return i}catch(e){return}},Pe=e=>{const t=e.threadProperties&&e.threadProperties[s.Q5.SpaceId];return(I(e)?e.id:(0,c.re)(e)?Ce(e):t)||e.teamId},Te=e=>{var t;const i=e.properties?null===(t=e.properties[s.Ff.Alerts])||void 0===t?void 0:t.trim().toLowerCase():void 0;return"true"!==i&&("false"===i||void 0)},Ie=e=>e.threadProperties&&((0,r.isBoolean)(e.threadProperties[s.Q5.GapDetectionEnabled])?e.threadProperties[s.Q5.GapDetectionEnabled]:"true"===(0,r.lowerCase)(e.threadProperties[s.Q5.GapDetectionEnabled])),_e=e=>{const t=Me(e);return t&&!me(e)&&ee(e)&&(0,r.some)(e.members,(e=>e.tenantId&&e.tenantId!==t))||we(e.id)||we(e.localClientId||"")},Ne=e=>{var t,i;return!(0,r.isNil)(e.threadProperties)&&(e.threadProperties[s.Q5.TemplateType]===s.Q5.ImmutableRoster||"true"===(null===(i=null===(t=e.threadProperties[s.Q5.IsStickyThread])||void 0===t?void 0:t.toString())||void 0===i?void 0:i.toLowerCase()))},we=e=>(0,r.startsWith)(e,s.At),Me=e=>e.threadProperties&&e.threadProperties[s.Q5.TenantId],xe=e=>{const t=I(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Space.toLowerCase(),i=E(e)&&e.threadProperties[s.Q5.ArchivalLevel]&&e.threadProperties[s.Q5.ArchivalLevel].toLowerCase()===s.C8.Topic.toLowerCase();return t||i},Ae=e=>function(e){if(!e.properties)return!1;return function(e){if(!e)return 0;const t=new Date(e),i=t?t.getTime():0;return isNaN(i)?0:i}(e.properties[s.Ff.LastImportantImTime])>Number(Le(e).originalArrivalTime)}(e),Le=e=>(0,r.isEmpty)(e.properties&&e.properties[s.Ff.ConsumptionHorizonBookmark])?(0,p.bf)(e):(0,p.BU)(e);const De=e=>{if(!e||!e.properties)return!1;const t=e.properties[s.Ff.isPinned];return!!t&&("boolean"==typeof t?t:"string"==typeof t&&"true"===t.toLowerCase())},Ee=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return!!(null==i?void 0:i.inQuarantine)},Ue=e=>{var t;const i=null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.RelationshipState];return"number"==typeof(null==i?void 0:i.quarantineCounter)?null==i?void 0:i.quarantineCounter:0},Oe=e=>{var t;return!!(null===(t=e.memberProperties)||void 0===t?void 0:t[s.e0.ExplicitlyAdded])},Fe=e=>{var t;return(null===(t=null==e?void 0:e.properties)||void 0===t?void 0:t.supressLastMessageUpdate)===s.Zt.Sender},Re=e=>{var t;return ee(e)&&!(null===(t=e.usersProps)||void 0===t?void 0:t.hasFederatedUser)&&(0,r.every)(e.members,(e=>{var t;return null===(t=e.id)||void 0===t?void 0:t.startsWith(s.rK)}))||!1}},917163:(e,t,i)=>{if(i.d(t,{Kz:()=>d,Kp:()=>l,eT:()=>p,uO:()=>u,aE:()=>m,eA:()=>h,h5:()=>v,vf:()=>f,Mw:()=>g}),740179==i.j)var n=i(471285);if(740179==i.j)var r=i(786884);if(740179==i.j)var a=i(65903);var o=i(197981);const s="ParsingMeetingUrl",d=e=>{const t=decodeURIComponent(e),i=new RegExp("context=(.*)$","g").exec(t);if(!i||i.length<2)throw c(`Meeting context is not in valid format ${t}`);const n=JSON.parse(i[1]);if(!n||!n.Tid||!n.Oid)throw c("Meeting url is malformed Tid or Oid is missing");return{tenantId:n.Tid,organizerId:n.Oid}},l=e=>e.context===s&&e.code===n.jK.ErrorParsingQueryParams,c=e=>(0,r.Tr)(s,n.jK.ErrorParsingQueryParams,"",void 0,e),p=(e,t,i)=>{const n=(e=>{const t="meet",i="meetup-join",n=new URL(e);let r;if(n.pathname.includes(t)||n.pathname.includes(i))r=n;else{if(!n.hash||!n.hash.includes(t)&&!n.hash.includes(i))throw c("Invalid URL - unsupported URL format");r=new URL(n.hash.substring(1),n.origin)}const a=r.searchParams,o=r.pathname.split("/"),s={isLegacyUrl:!1,meetingCloud:r.hostname,meetingUrl:e};if(o[2]===i){const e=a.get("context");if(5!==o.length||!e)throw c("Invalid URL - context param is missing");s.threadId=decodeURIComponent(o[3]),s.messageId=decodeURIComponent(o[4]);const t=JSON.parse(decodeURIComponent(e));if(!t.Tid||!t.Oid)throw c("Invalid URL - context param is invalid. Tid or Oid missing.");s.tenantId=t.Tid,s.organizerId=t.Oid,s.isBroadcastMeeting=t.IsBroadcastMeeting||void 0,s.attendeeRole=t.role||void 0,s.replyChainMessageId=t.MessageId||void 0,s.isLegacyUrl=!0}else{if(o[1]!==t)throw c("Invalid URL - unsupported URL format");s.meetingId=o[2],s.passCode=a.get("p")||void 0}return s})(e);let r;return r=n.isLegacyUrl?{type:a.GXC.Meeting,joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:i},coordinates:{legacyMeeting:{meetingCloud:n.meetingCloud,conversationId:n.threadId||"",rootMessageId:n.messageId||"",messageId:n.replyChainMessageId||n.messageId||"",isChannel:"0"!==n.messageId,isAdhoc:!1,tenantId:n.tenantId||"",organizerId:n.organizerId||""}}}:{type:a.GXC.Meeting,joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:i},coordinates:{meetingData:{meetingUrl:e}}},r},u=e=>{var t,i,n,r;try{return new URL(e).hostname}catch(a){return(null===(r=null===(n=null===(i=null===(t=e.split("/"))||void 0===t?void 0:t[2])||void 0===i?void 0:i.split("@"))||void 0===n?void 0:n.pop())||void 0===r?void 0:r.split(":").shift())||""}},m=e=>{let t=!1;if(e&&e.skypeTeamsDataObj){t=1===e.skypeTeamsDataObj.type}return t};function h(e){return!(!e||!e.skypeTeamsDataObj||(0,o.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}const v=e=>{var t;return!!(null===(t=e.webinarRegistration)||void 0===t?void 0:t.webinarId)},f=e=>{var t;return!!(null===(t=e.virtualEventsData)||void 0===t?void 0:t.eventId)},g=e=>{try{return"meet"===new URL(e).pathname.split("/")[1]}catch(e){return!1}}},245349:(e,t,i)=>{if(i.d(t,{Hk:()=>a,Rd:()=>o,By:()=>s}),740179==i.j)var n=i(361366);function r(e,t){if(!e.startsWith("blob"))return Promise.reject("invalid blob url");const i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType=t,new Promise(((e,t)=>{i.onload=()=>{200===i.status&&i.response?e(i.response):t(200!==i.status?{status:i.status,statusText:i.statusText}:{status:404,statusText:"no response data"})},i.onerror=()=>{t({status:i.status,statusText:i.statusText})},i.send()}))}function a(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return yield r(e,"blob")}))}function o(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const t=yield r(e,"arraybuffer");return new Uint8Array(t)}))}function s(e){return(0,n.__awaiter)(this,void 0,void 0,(function*(){return e.then((e=>URL.createObjectURL(e)))}))}},513368:(e,t,i)=>{i.d(t,{Fd:()=>o,s3:()=>d,HC:()=>l,wm:()=>c,LY:()=>p,Bj:()=>u});var n=i(197981);if(740179==i.j)var r=i(759704);var a=i(469929);function o(e,t){try{const i=s(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,n.uniqBy)(t,(e=>e.toLowerCase()))){let t="";const n=e.split(".");for(let e=0;e<n.length;e++)t+=(e>0?"[.]":"")+n[e].replace("*","[^/^.]+");const r=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(i.match(r))return!0}}catch(e){return!1}return!1}const s=e=>new URL(e).href,d=(e,t)=>{let i="";if(!e.id||c(e.id))return i;switch(e.type){case r.p.extensions:try{i=JSON.parse(e.id).threadId}catch(t){i=e.id}break;case r.p.chats:i=e.id.replace("replyChainId","messageid");break;case r.p.communities:case r.p.channels:let n;try{n=JSON.parse(e.id).channelId}catch(t){n=e.id}i=t?`${n};messageid=${t}`:n;break;case r.p.shareformdialog:break;default:i=e.id}return i},l=e=>e&&e.replace(new RegExp(`^${a.at.BotPrefix}`),""),c=e=>"newchat"===e||(null==e?void 0:e.includes("preview")),p=(e,t=a.Cs.Call)=>t===a.Cs.Call&&/<partlist/.test(e)&&!u(e,t),u=(e,t=a.Cs.Call)=>t===a.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},654760:(e,t,i)=>{i.d(t,{X:()=>n,si:()=>a,D:()=>o});const n="other";var r;function a(e){return!!r[e]}function o(){return Object.keys(r).filter((e=>isNaN(Number(e))))}!function(e){e[e["3mf"]=0]="3mf",e[e.cool=1]="cool",e[e.glb=2]="glb",e[e.gltf=3]="gltf",e[e.obj=4]="obj",e[e.stl=5]="stl",e[e.movie=6]="movie",e[e.pages=7]="pages",e[e.pict=8]="pict",e[e.sketch=9]="sketch",e[e.ai=10]="ai",e[e.pdf=11]="pdf",e[e.psb=12]="psb",e[e.psd=13]="psd",e[e["3g2"]=14]="3g2",e[e["3gp"]=15]="3gp",e[e.asf=16]="asf",e[e.bmp=17]="bmp",e[e.hevc=18]="hevc",e[e.m2ts=19]="m2ts",e[e.m4v=20]="m4v",e[e.mov=21]="mov",e[e.mp3=22]="mp3",e[e.mp4=23]="mp4",e[e.mp4v=24]="mp4v",e[e.mts=25]="mts",e[e.ts=26]="ts",e[e.wmv=27]="wmv",e[e.dwg=28]="dwg",e[e.fbx=29]="fbx",e[e.erf=30]="erf",e[e.zip=31]="zip",e[e["7z"]=32]="7z",e[e.z=33]="z",e[e.dcm=34]="dcm",e[e.dcm30=35]="dcm30",e[e.dicm=36]="dicm",e[e.dicom=37]="dicom",e[e.ply=38]="ply",e[e.hcp=39]="hcp",e[e.gif=40]="gif",e[e.heic=41]="heic",e[e.heif=42]="heif",e[e.jpeg=43]="jpeg",e[e.jpg=44]="jpg",e[e.jpe=45]="jpe",e[e.mef=46]="mef",e[e.mrw=47]="mrw",e[e.nef=48]="nef",e[e.nrw=49]="nrw",e[e.orf=50]="orf",e[e.pano=51]="pano",e[e.pef=52]="pef",e[e.png=53]="png",e[e.rw2=54]="rw2",e[e.spm=55]="spm",e[e.tif=56]="tif",e[e.tiff=57]="tiff",e[e.xbm=58]="xbm",e[e.xcf=59]="xcf",e[e.key=60]="key",e[e.csv=61]="csv",e[e.dic=62]="dic",e[e.doc=63]="doc",e[e.docm=64]="docm",e[e.docx=65]="docx",e[e.dot=66]="dot",e[e.dotm=67]="dotm",e[e.dotx=68]="dotx",e[e.pot=69]="pot",e[e.potm=70]="potm",e[e.potx=71]="potx",e[e.pps=72]="pps",e[e.ppsm=73]="ppsm",e[e.ppsx=74]="ppsx",e[e.ppt=75]="ppt",e[e.pptm=76]="pptm",e[e.pptx=77]="pptx",e[e.xd=78]="xd",e[e.xls=79]="xls",e[e.xlsb=80]="xlsb",e[e.xlsm=81]="xlsm",e[e.xlsx=82]="xlsx",e[e.sltx=83]="sltx",e[e.eml=84]="eml",e[e.msg=85]="msg",e[e.vsd=86]="vsd",e[e.vsdx=87]="vsdx",e[e.cur=88]="cur",e[e.ico=89]="ico",e[e.icon=90]="icon",e[e.epub=91]="epub",e[e.odp=92]="odp",e[e.ods=93]="ods",e[e.odt=94]="odt",e[e.arw=95]="arw",e[e.cr2=96]="cr2",e[e.crw=97]="crw",e[e.dng=98]="dng",e[e.rtf=99]="rtf",e[e.abap=100]="abap",e[e.ada=101]="ada",e[e.adp=102]="adp",e[e.ahk=103]="ahk",e[e.as=104]="as",e[e.as3=105]="as3",e[e.asc=106]="asc",e[e.ascx=107]="ascx",e[e.asm=108]="asm",e[e.asp=109]="asp",e[e.awk=110]="awk",e[e.bas=111]="bas",e[e.bash=112]="bash",e[e.bash_login=113]="bash_login",e[e.bash_logout=114]="bash_logout",e[e.bash_profile=115]="bash_profile",e[e.bashrc=116]="bashrc",e[e.bat=117]="bat",e[e.bib=118]="bib",e[e.bsh=119]="bsh",e[e.build=120]="build",e[e.builder=121]="builder",e[e.c=122]="c",e[e.capfile=123]="capfile",e[e.cbk=124]="cbk",e[e.cc=125]="cc",e[e.cfc=126]="cfc",e[e.cfm=127]="cfm",e[e.cfml=128]="cfml",e[e.cl=129]="cl",e[e.clj=130]="clj",e[e.cmake=131]="cmake",e[e.cmd=132]="cmd",e[e.coffee=133]="coffee",e[e.cpp=134]="cpp",e[e.cpt=135]="cpt",e[e.cpy=136]="cpy",e[e.cs=137]="cs",e[e.cshtml=138]="cshtml",e[e.cson=139]="cson",e[e.csproj=140]="csproj",e[e.css=141]="css",e[e.ctp=142]="ctp",e[e.cxx=143]="cxx",e[e.d=144]="d",e[e.ddl=145]="ddl",e[e.dif=146]="dif",e[e.diff=147]="diff",e[e.disco=148]="disco",e[e.dml=149]="dml",e[e.dtd=150]="dtd",e[e.dtml=151]="dtml",e[e.el=152]="el",e[e.emake=153]="emake",e[e.erb=154]="erb",e[e.erl=155]="erl",e[e.f90=156]="f90",e[e.f95=157]="f95",e[e.fluid=158]="fluid",e[e.fs=159]="fs",e[e.fsi=160]="fsi",e[e.fsscript=161]="fsscript",e[e.fsx=162]="fsx",e[e.gemfile=163]="gemfile",e[e.gemspec=164]="gemspec",e[e.gitconfig=165]="gitconfig",e[e.go=166]="go",e[e.groovy=167]="groovy",e[e.gvy=168]="gvy",e[e.h=169]="h",e[e.haml=170]="haml",e[e.handlebars=171]="handlebars",e[e.hbs=172]="hbs",e[e.hrl=173]="hrl",e[e.hs=174]="hs",e[e.htc=175]="htc",e[e.hxx=176]="hxx",e[e.idl=177]="idl",e[e.iim=178]="iim",e[e.inc=179]="inc",e[e.inf=180]="inf",e[e.ini=181]="ini",e[e.inl=182]="inl",e[e.ipp=183]="ipp",e[e.ipynb=184]="ipynb",e[e.irbrc=185]="irbrc",e[e.jade=186]="jade",e[e.jav=187]="jav",e[e.java=188]="java",e[e.jfif=189]="jfif",e[e.js=190]="js",e[e.json=191]="json",e[e.jsp=192]="jsp",e[e.jsx=193]="jsx",e[e.l=194]="l",e[e.less=195]="less",e[e.lhs=196]="lhs",e[e.lisp=197]="lisp",e[e.log=198]="log",e[e.lst=199]="lst",e[e.ltx=200]="ltx",e[e.lua=201]="lua",e[e.m=202]="m",e[e.make=203]="make",e[e.markdn=204]="markdn",e[e.mdown=205]="mdown",e[e.mkdn=206]="mkdn",e[e.ml=207]="ml",e[e.mli=208]="mli",e[e.mll=209]="mll",e[e.mly=210]="mly",e[e.mm=211]="mm",e[e.mud=212]="mud",e[e.nfo=213]="nfo",e[e.opml=214]="opml",e[e.osascript=215]="osascript",e[e.out=216]="out",e[e.p=217]="p",e[e.pas=218]="pas",e[e.patch=219]="patch",e[e.php=220]="php",e[e.php2=221]="php2",e[e.php3=222]="php3",e[e.php4=223]="php4",e[e.php5=224]="php5",e[e.pl=225]="pl",e[e.plist=226]="plist",e[e.pm=227]="pm",e[e.pod=228]="pod",e[e.pp=229]="pp",e[e.profile=230]="profile",e[e.properties=231]="properties",e[e.ps=232]="ps",e[e.ps1=233]="ps1",e[e.pt=234]="pt",e[e.py=235]="py",e[e.pyw=236]="pyw",e[e.r=237]="r",e[e.rake=238]="rake",e[e.rb=239]="rb",e[e.rbx=240]="rbx",e[e.rc=241]="rc",e[e.re=242]="re",e[e.readme=243]="readme",e[e.reg=244]="reg",e[e.rest=245]="rest",e[e.resw=246]="resw",e[e.resx=247]="resx",e[e.rhtml=248]="rhtml",e[e.rjs=249]="rjs",e[e.rprofile=250]="rprofile",e[e.rpy=251]="rpy",e[e.rss=252]="rss",e[e.rst=253]="rst",e[e.rxml=254]="rxml",e[e.s=255]="s",e[e.sass=256]="sass",e[e.scala=257]="scala",e[e.scm=258]="scm",e[e.sconscript=259]="sconscript",e[e.sconstruct=260]="sconstruct",e[e.script=261]="script",e[e.scss=262]="scss",e[e.sgml=263]="sgml",e[e.sh=264]="sh",e[e.shtml=265]="shtml",e[e.sml=266]="sml",e[e.sql=267]="sql",e[e.sty=268]="sty",e[e.tcl=269]="tcl",e[e.tex=270]="tex",e[e.text=271]="text",e[e.textile=272]="textile",e[e.tld=273]="tld",e[e.tli=274]="tli",e[e.tmpl=275]="tmpl",e[e.tpl=276]="tpl",e[e.txt=277]="txt",e[e.vb=278]="vb",e[e.vi=279]="vi",e[e.vim=280]="vim",e[e.wsdl=281]="wsdl",e[e.xaml=282]="xaml",e[e.xhtml=283]="xhtml",e[e.xoml=284]="xoml",e[e.xml=285]="xml",e[e.xsd=286]="xsd",e[e.xsl=287]="xsl",e[e.xslt=288]="xslt",e[e.yaml=289]="yaml",e[e.yaws=290]="yaws",e[e.yml=291]="yml",e[e.zsh=292]="zsh",e[e.htm=293]="htm",e[e.html=294]="html",e[e.markdown=295]="markdown",e[e.md=296]="md",e[e.url=297]="url",e[e.one=298]="one",e[e.note=299]="note"}(r||(r={}))},117064:(e,t,i)=>{i.d(t,{Q:()=>o});var n=i(435054);const r=new RegExp(n.yH.oneDriveFile),a=new RegExp(n.yH.sharePointFile),o=(e,t)=>{if(t){const i=t.replace(n.yH.leadingAndTrailingSlashesRegex,"").split("/");i.pop();const r=i.join("/");return`${new URL(e).origin}/${r}/`}if(a.test(e)){const t=e.match(a);return t?t[0]:null}if(r.test(e)){const t=e.match(r);return t?t[0]:null}if(e){const t=e.split("/"),i=2;if(t.length>=i)return`${t[0]}//${t[i]}/`}return e}},435054:(e,t,i)=>{i.d(t,{as:()=>n,Ho:()=>r,HV:()=>a,Hr:()=>o,yH:()=>s,v$:()=>d,wg:()=>l,BY:()=>c,Y_:()=>p,Bx:()=>u,MI:()=>m,Aq:()=>h,N0:()=>v,BS:()=>f,Fk:()=>g,Z2:()=>S,Z$:()=>k,ov:()=>y,Mc:()=>b,p5:()=>C,xK:()=>P,_v:()=>T,JJ:()=>I});const n={url:{getDriveItemAndPermissions:"/_api/v2.0/shares/{shareID}",fetchShareInfo:"/_api/v2.0/shares/{shareID}/driveItem",getDriveItemWithId:"/_api/v2.0/sites/root/items/{fileId}/driveItem",defaultPermissionsWithFileId:"/_api/v2.0/sites/root/items/{fileID}/driveItem/commands",getLinkPermissions:"/_api/v2.0/shares/{shareID}/permission",fetchVideoInfoWithThumbnails:"/_api/v2.0/shares/{shareID}/driveItem?$expand=thumbnails",createLinkWithId:"/_api/v2.1/sites/root/items/{id}/driveItem/createLink",createLinkWithShareId:"/_api/v2.1/shares/{shareId}/driveItem/createLink",getSharingInformation:"/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid",getSharingInformationByUrl:"_api/web/GetFileByUrl(@a1)/ListItemAllFields/GetSharingInformation?@a1="}},r={THREAD_ID_UPDATE_URL:"beta/teams/recent/files/backfillSpoIds?threadId={channelThreadId}",THREAD_ID_UPDATE_APINAME:"backfillSpoIds"},a={personal:"personal",teams:"teams"},o={bim:"bim",mw:"mw",ns:"ns",rwc:"rwc"},s={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${a.personal}/[^/]*/`,sharePointFile:`.*/(${a.teams}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\\/\:\*\?\"\<\>\|\#\%\t]*$/},d={personal:"personal",sharePoint:"share-point"},l={states:{active:"active",deleted:"deleted",reference:"reference",removed:"removed"}},c={type:"oneNote",extension:"one",extensionWithDot:".one"},p={openInTeams:"OpenFileInTeamsViewer",editInTeams:"EditInTeams",openInOfficeOnline:"OpenInOfficeOnline",openInOfficeClient:"OpenInOfficeClient"},u={clientError:-1,ok:200,badRequest:400,unauthorizedAccess:401,forbidden:403,notFound:404,notAcceptable:406,conflict:409,locked:423,tooManyRequests:429,internalServerError:500,serviceUnavailable:503,notModified:304},m={uploadCancelled:"UPLOAD_CANCELLED",conflicted:"-2130575257",conflicted_v2:"-2147024816",conflicted_v3:"nameAlreadyExists",folderDoesNotExist:"-2147024893",locked:"-2147018894",spQuotaReached:"-2147023080",quotaLimitReached:"quotaLimitReached",fileNotFound:"-2130575338",itemNotFound:"itemNotFound",fileAccessDenied:"FileAccessDenied",accessDenied:"accessDenied",sessionInProgress:"-2130575142",unauthorizedAccessException:"-2147024891",cobaltException:"-1, Cobalt.ErrorException",resourceLockedException:"-2147018887",audienceUriValidationFailedException:"Microsoft.IdentityModel.Tokens.AudienceUriValidationFailedException",unauthenticated:"unauthenticated",invalidAudienceUri:"invalidAudienceUri",siteRenameFailure:"-2147024809",notAllowed:"notAllowed",resourceLocked:"resourceLocked",authChallengeRequired:"authChallengeRequired"};var h,v,f,g;!function(e){e.filePropertiesMissing="FILE_PROPERTIES_MISSING",e.maxFilesAttachment="MAX_FILES_ATTACHMENT",e.nullFiles="NULL_FILES",e.zeroSizeFile="ZERO_SIZE_FILE",e.titleContainSpecialCharacter="TITLE_CONTAIN_SPECIAL_CHARACTER",e.blacklistedFiletype="BLACK_LIST_FILE_TYPE",e.fileNameTooLong="FILE_NAME_TOO_LONG",e.siteInfoNotFound="SITE_INFO_NOT_FOUND",e.spQuotaReached="SP_QUOTA_REACHED",e.fileNotPresent="FILE_NOT_PRESENT",e.fileAccessDenied="FILE_ACCESS_DENIED",e.fileLocked="FILE_LOCKED",e.siteNotProvisioned="SITE_NOT_PROVISIONED",e.siteNotProvisionedSubtext="SITE_NOT_PROVISIONED_SUBTEXT",e.channelSiteNotProvisioned="CHANNEL_SITE_NOT_PROVISIONED",e.channelSiteNotProvisionedSubtext="CHANNEL_SITE_NOT_PROVISIONED_SUBTEXT",e.fileAlreadyAttachedInMessage="FILE_WITH_SAME_NAME_ALREADY_ATTACHED_IN_MESSAGE",e.audienceUriValidationFailed="INVALID_AUDIENCE_URI"}(h||(h={})),function(e){e.UNKNOWN_UPLOAD_ERROR="UNKNOWN_UPLOAD_ERROR"}(v||(v={})),function(e){e.InvalidRequest="invalidRequest",e.Unhandled="Unhandled"}(f||(f={})),function(e){e.ShareLinkCSL="files_messages_sharelink_csl",e.ShareLinkPSLWithoutIndividualAccess="files_messages_sharelink_psl_without_individual_access",e.ShareLinkPSLWithoutIndividualWrite="files_messages_sharelink_psl_without_individual_write_access",e.ShareLinkPSLWithoutFutureAccess="files_messages_sharelink_psl_without_future_access",e.ShareLinkPSLWithoutFullAndFutureAccess="files_messages_sharelink_psl_without_full_and_future_access",e.ShareLinkPSLWithoutWriteAndFutureAccess="files_messages_sharelink_psl_without_write_and_future_access",e.ShareLinkFederatedAndGuestCSL="files_messages_sharelink_federated_and_guest_csl",e.ShareLinkFederatedCSL="files_messages_sharelink_federated_csl",e.ShareLinkPSLWithoutFullAccess="files_messages_sharelink_psl_without_full_access",e.ShareLinkCSLXTenantSharedChannel="files_messages_sharelink_csl_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessXTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_xtenant_sharedchannel",e.ShareLinkPSLWithoutFullAndFutureAccessInTenantSharedChannel="files_messages_sharelink_psl_without_full_and_future_access_intenant_sharedchannel"}(g||(g={}));const S=100,k=10485760,y=12e4,b=3e5,C=600;var P;!function(e){e.GRAPH_URL_KEY="@microsoft.graph.downloadUrl",e.CONTENT_URL_KEY="@content.downloadUrl"}(P||(P={}));const T="/_layouts/15/Doc.aspx?OR=teams&action=edit&sourcedoc=";var I;!function(e){e.InvalidURL="InvalidURL",e.InvalidURLProtocol="InvalidURLProtocol",e.Invalid3PURLDomain="Invalid3PURLDomain",e.InvalidSPOOrPersonalSiteDomain="InvalidSPOOrPersonalSiteDomain",e.DifferentURLDomains="DifferentURLDomains"}(I||(I={}))},921297:(e,t,i)=>{if(i.d(t,{X:()=>r}),740179==i.j)var n=i(435054);const r=e=>{switch(e){case n.Bx.unauthorizedAccess:return!1;case n.Bx.clientError:case n.Bx.badRequest:case n.Bx.internalServerError:case n.Bx.serviceUnavailable:case n.Bx.tooManyRequests:return!0;default:return!1}}},694065:(e,t,i)=>{if(i.d(t,{P:()=>r}),740179==i.j)var n=i(487722);function r(e){const t=e.performance;let i,r,a;const o=null==t?void 0:t.memory;return o&&(i=(0,n.kl)(o.jsHeapSizeLimit),r=(0,n.kl)(o.totalJSHeapSize),a=(0,n.kl)(o.usedJSHeapSize)),{jsHeapSizeLimit:i,totalJSHeapSize:r,usedJSHeapSize:a}}},945607:(e,t,i)=>{if(i.d(t,{K:()=>a}),740179==i.j)var n=i(361366);if(740179==i.j)var r=i(487722);function a(e,t){return(0,n.__awaiter)(this,void 0,void 0,(function*(){const i={workers:[],processes:[],windows:[]},n=yield null==e?void 0:e.loadModule("heartbeat");if(!(null==n?void 0:n.getPerfMetrics))return i;try{if(t&&(null==n?void 0:n.getPerfMetricsAsync)){const{processes:e,workers:t,windows:a}=yield n.getPerfMetricsAsync();for(const e of t)i.workers.push({targetSessionId:e.targetSessionId,type:e.type,subType:e.subType,totalSizeKB:(0,r.kl)(e.totalSizeBytes),usedSizeKB:(0,r.kl)(e.usedSizeBytes)});for(const t of e)i.processes.push({processId:t.processId,name:t.name,type:t.type,utilitySubType:t.utilitySubType,embeddedBrowserWebView:t.embeddedBrowserWebView,cpuCycleTime:t.cpuCycleTime,workingSetSizeKB:(0,r.kl)(t.workingSetSizeBytes),commitSizeKB:(0,r.kl)(t.pageFileUsageBytes)});i.windows=a}else{const e=yield n.getPerfMetrics();for(const t of e)i.processes.push({processId:t.processId,name:t.name,type:t.type,utilitySubType:t.utilitySubType,embeddedBrowserWebView:t.embeddedBrowserWebView,cpuCycleTime:t.cpuCycleTime,workingSetSizeKB:(0,r.kl)(t.workingSetSizeBytes),commitSizeKB:(0,r.kl)(t.pageFileUsageBytes)})}}catch(e){console.error("get-webview-2-metrics, getMetrics: Failed to get metrics.")}return i}))}},487722:(e,t,i)=>{i.d(t,{tC:()=>r,Mv:()=>a,RQ:()=>o,kl:()=>s,ev:()=>d});var n=i(197981);function r(e){const t={},i=[...e];return u(t,"TelemetryWorker",g(i,"TelemetryWorker")),u(t,"CDLWorker",g(i,"CDLWorker")),u(t,"ServiceWorker",g(i,"ServiceWorker")),t.Perf_Total_NumberOfCDLWorkers=f(e,"CDLWorker"),t.Perf_Total_NumberOfServiceWorkers=f(e,"ServiceWorker"),t.Perf_Total_NumberOfTelemetryWorkers=f(e,"TelemetryWorker"),t.Perf_Total_NumberOfWorkers=e.length,t}function a(e,t,i){const n={},r=[...e];m(n,"GPU",v(r,["gpu-process","Gpu"]),t),m(n,"NativeShell",v(r,["nativeShell","NativeShell"]),t),m(n,"CrashpadHandler",v(r,"crashpad-handler"),t),m(n,"Browser",v(r,["browser","Browser"]),t);const a=v(r,["renderer","Renderer"]);n.Perf_Renderer_Count_Processes=a.length,m(n,"Renderer",a,t),m(n,"SlimCore",v(r,["NativeModuleProcess_SlimCore"]),t);const o=v(r,["utility","Utility"]);if(m(n,"Utility",o,t),n.Perf_Utility_Process=[...o],k(n,"NetworkService",S(o,"NetworkService")),k(n,"StorageService",S(o,"StorageService")),k(n,"AudioService",S(o,"AudioService")),m(n,"Total",e),n.Perf_Total_NumberOfProcesses=e.length,n.Perf_Unknown_Process=r,n.Perf_Unknown_NumberOfProcesses=r.length,n.Perf_Unknown_WorkingSet=c(r),n.Perf_Unknown_CommitSize=p(r),i){const r=e.find((e=>e.processId===i));r&&(n.Perf_MainRenderer_WorkingSet=c([r]),n.Perf_MainRenderer_CommitSize=p([r]),n.Perf_MainRenderer_PeakWorkingSet=null==t?void 0:t.get(i))}return n}function o(e,t){const i={},{totalJSHeapSize:n,jsHeapSizeLimit:r,usedJSHeapSize:a}=e;return n&&(i.Perf_JSHeap_TotalSize=n),r&&(i.Perf_JSHeap_LimitSize=r),a&&(i.Perf_JSHeap_UsedSize=a),t&&(i.Perf_Peak_UsedJSHeapSize=t),i}function s(e){return"number"!=typeof e||isNaN(e)?void 0:Math.round(e/1024)}const d=740179==i.j?s:null;function l(e,t){const i=(0,n.sumBy)(e,(e=>{var i;return null!==(i=e[t])&&void 0!==i?i:NaN}));return 0===e.length||isNaN(i)?void 0:i}function c(e){return l(e,"workingSetSizeKB")}function p(e){return l(e,"commitSizeKB")}function u(e,t,i){e[`Perf_${t}_UsedSize`]=function(e){return l(e,"usedSizeKB")}(i),e[`Perf_${t}_TotalSize`]=function(e){return l(e,"totalSizeKB")}(i)}function m(e,t,i,n){if(e[`Perf_${t}_WorkingSet`]=c(i),e[`Perf_${t}_CommitSize`]=p(i),"Total"===t)e.Perf_Total_NumberOfProcesses=i.length;else{if(e[`Perf_${t}_Count_Processes`]=i.length,!n||!i.length)return;const r=Math.max(...i.map((e=>n.get(e.processId)||0)));r&&(e[`Perf_${t}_PeakWorkingSet`]=r)}}function h(e,t){let i;const n=[];for(;i=e.findIndex(t),-1!==i;)n.push(e.splice(i,1)[0]);return n}function v(e,t){const i="string"==typeof t?[t]:t;return h(e,(e=>i.includes(e.type)))}const f=(e,t)=>e.filter((e=>e.subType===t)).length;function g(e,t){return h(e,(e=>e.subType.includes(t)))}function S(e,t){return h(e,(e=>e.utilitySubType.includes(t)))}function k(e,t,i){e[`Perf_${t}_WorkingSet`]=c(i),e[`Perf_${t}_CommitSize`]=p(i),e[`Perf_${t}_Count_Processes`]=i.length}},325276:(e,t,i)=>{i.d(t,{hN:()=>a,jE:()=>s,mo:()=>c,PI:()=>p,Xn:()=>u,BN:()=>v,Np:()=>f,mW:()=>g,Qz:()=>S,zG:()=>k,cE:()=>y,Wg:()=>b,_Y:()=>C,cI:()=>T,t_:()=>I,gC:()=>w});var n=i(469929);if(740179==i.j)var r=i(97600);var a,o,s,d=i(197981);if(740179==i.j)var l=i(381583);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(a||(a={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(o||(o={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(s||(s={}));const c=e=>!!(e&&e.coExistenceMode&&a[e.coExistenceMode]),p=e=>!(e!==a.TeamsOnly),u=e=>!(-1===[a.Islands,a.IslandsWithTempInterop,a.IslandsWithVoipDeepLinking].indexOf(e)),m=e=>!(-1===[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings].indexOf(e)),h=(e,t,i=!1)=>{const r=[n.Jq,n.Dr,n.iO,n.TO,n.pk,n.P_],a=e.split(":");return r.some((e=>{const n=a.findIndex((t=>t===e.slice(0,-1)));return n>=0&&(i?a.splice(n+1,1):a.splice(n+1,0,t.slice(0,-1)),!0)})),a.join(":")},v=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.pW,e)&&e.includes(n.pW),f=e=>!e||v(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.pW):void 0,g=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.m_,e)&&e.includes(n.m_),S=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.U0,e)&&e.includes(`:${n.U0}`),k=e=>!e||S(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.U0):void 0,y=e=>!e||g(e)?e:e.includes(n.at.SkypeSpacesUser)?h(e,n.m_):void 0,b=e=>{if(e){if(v(e))return h(e,n.pW,!0);if(g(e))return h(e,n.m_,!0)}return e},C=e=>e?S(e)?h(e,n.U0,!0):void 0:e,P={isAllowed:!1},T=(e,t,i,n,r,a,o,s)=>{const d=o&&o.coExistenceMode,l=a&&a.coExistenceMode;if(!d||!l)return{isAllowed:!0};if(n){const n=((e,t,i,n,r,a,o)=>{const s=o.newLogger("sfb-interop");return a.isFederated?!n&&i?(s.log("Chat Disabled: current user is not provisioned on Sfb online"),P):a.coExistenceMode&&r.coExistenceMode?e&&i&&p(r.coExistenceMode)&&p(a.coExistenceMode)?{isAllowed:!1,mri:y(a.mri||"")}:i||t||!u(r.coExistenceMode)&&!u(a.coExistenceMode)?!i&&m(a.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:a.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:a.mri}:(s.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(s.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(a))})(e,t,i,r,a,o,s);if(!n.isAllowed)return n}else{const e=((e,t)=>t.coExistenceMode?e&&p(t.coExistenceMode)?{isAllowed:!1,mri:b(t.mri||"")}:!e&&m(t.coExistenceMode)?{isAllowed:!1,mri:f(t.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(i,o);if(!e.isAllowed)return e}return{isAllowed:!0}},I=e=>{const t=g(e);return _(e)||v(e)||t?t?e.replace(n.m_,""):e.replace(n.pW,"").replace(n.zt,""):e},_=e=>!!e&&!(0,d.startsWith)(n.at.SkypeSpacesUser+n.zt,e)&&e.includes(n.zt),N=(e,t,i,n)=>{const r=e.isFederated,a=(s=e.mri||"",(0,d.endsWith)(s,"@sfbonprem.unq.gbl.spaces"));var s;if(t&&r&&!a&&e.coExistenceMode){const t=o[e.coExistenceMode],r=i===o.TeamsOnly&&t===o.TeamsOnly;return r||n.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${o[i]} recipientCoexistenceMode:${o[t]}`),r}return n.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${t} isFederated:${r} isOnPremFederated:${a} coExistenceMode:${e.coExistenceMode}`),!1},w=(e,t,i,n,a,d)=>{if(!(e&&e.mri&&e.userType!==l.vf.guest&&e.type!==l.vf.skypeConsumer&&e.type!==l.vf.tflUser&&(0,r.eZ)(e.mri)))return i.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),s.Teams;if(e.isFederated)return i.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),N(e,a,d,i)?s.NativeFederated:s.Federated;const c=((e,t,i)=>{const n=e.coExistenceMode,r=o[n];if(i.log(`getCoexistenceChatMode - caller: ${t}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${o[r]}, MT coExistenceMode: ${n}`),o[r]!==n&&i.error(`getUserChatMode - Mapping error - coExistenceMode : ${o[r]}, MT coExistenceMode: ${n}`),r){const e=[o.SfBOnly,o.SfBWithTeamsCollab,o.SfBWithTeamsCollabAndMeetings],t=[o.TeamsOnly,o.Islands,o.IslandsWithVoipDeepLinking];if(e.includes(r))return s.SfB;if(t.includes(r))return s.Teams;i.warn(`getUserChatMode - unknown coExistenceMode ${o[r]}`)}else e.isShortProfile||i.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,t,i);if(c)return c;const p=v(e.mri),u=e.isSkypeTeamsUser,m=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return i.log(`getUserChatMode - caller: ${t}, mri: ${e.mri}, isSfbMri: ${p}, isTeamsChatEnabled: ${m}, hasLoggedInToTeams: ${u}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${n}`),!p&&u&&m||e.isSipDisabled||!n?s.Teams:s.SfB}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/329575-2af442dc1c8cfe0f.js.map